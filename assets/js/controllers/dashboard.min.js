EMAPP.templateCache.put("assets/html/dashboard.html?rev=f648c8840e",'<div class="app-view-dashboard"><nav class="navbar navbar-default"><div class="pull-left" ng-bind="::self.projectName"></div><div class="pull-right"><div class="btn-group"><span><i class="emweb web-clock"></i> <span ng-bind="self.timeStr"></span></span></div><div class="btn-group" ng-if="self.projectData.length && self.groupmode"><a href="javascript:void(0)" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">集团项目<span class="caret"></span></a><ul class="dropdown-menu"><li ng-repeat="item in self.projectData"><a target="_blank" ng-href="/dashboard{{item._id}}/main" ng-bind="item.title"></a></li></ul></div><div class="btn-group"><a class="btn btn-primary" target="_blank" href="http://sighttp.qq.com/authd?IDKEY=c7520bcf5154b71353e5f9bbcc742e8f37dab53dc23d63c5"><i class="emweb web-QQ"></i> <small>QQ客服</small></a></div><div class="btn-group"><a class="btn btn-primary" ng-href="{{::self.adminLink}}"><i class="emweb web-user"></i> <span ng-bind="::self.userName"></span></a></div><div class="btn-group"><a class="btn btn-primary" href="/dashboard/auth/logout"><i class="emweb web-exit"></i> <small>退出</small></a></div></div></nav><div class="view-sidebar"><ul class="nav"><li ng-repeat="item in self.menuData" ng-class="{active:self.menuData.active===item.state}"><a ui-sref="{{::item.state}}" title="{{::item.name}}"><i ng-class="::item.icon"></i></a></li></ul></div><div class="view-content" ui-view="dashboard"></div></div>'),angular.module("EMAPP").controller("EMAPP.dashboard",["$scope","$state","$stateParams","$location","$timeout","$api","$q",function(e,t,a,o,r,n,s){var i=this,c=sessionStorage.projectid,m=r(function d(){i.timeStr=moment().format("H:mm:ss"),m=r(d,1e3)});e.$on("$destroy",function(){delete EMAPP.Project,r.cancel(m)}),i.userName=EMAPP.User.user,i.adminLink=/cloudenergy\.me/.test(location.hostname)?location.origin.replace("pre.","preadmin.").replace("www.","admin."):"/admin",s.all([n.auth.login(function(e){EMAPP.User=e&&e.result||EMAPP.User||{}}).$promise,n.project.info({id:c||void 0},function(e){e.result=angular.isArray(e.result)&&e.result||e.result&&[e.result]||[],angular.forEach(EMAPP.Project=i.projectData=e.result,function(e){this.push(e._id),EMAPP.Project[e._id]=e},EMAPP.Project.ids=[])}).$promise]).then(function(){return EMAPP.Project.length?((EMAPP.User.groupmode=i.groupmode=EMAPP.User.groupuser&&!c)?(document.title=EMAPP.title=i.projectName="集团平台",i.menuData=[{state:"dashboard.main",name:"首页",icon:"emweb web-home"},{state:"dashboard.monitor",name:"监控",icon:"emweb web-camera"},{state:"dashboard.analyze",name:"分析",icon:"emweb web-analyze"},{state:"dashboard.statistic",name:"统计",icon:"emweb web-pie-chart"}]):(EMAPP.Project.current=EMAPP.Project[0]||{},document.title=EMAPP.title=i.projectName=EMAPP.Project.current.title||i.projectName,i.menuData=[{state:"dashboard.main",name:"首页",icon:"emweb web-home"},{state:"dashboard.monitor",name:"监控",icon:"emweb web-camera"},{state:"dashboard.control",name:"控制",icon:"emweb web-control"},{state:"dashboard.analyze",name:"分析",icon:"emweb web-analyze"},{state:"dashboard.statistic",name:"统计",icon:"emweb web-pie-chart"},{state:"dashboard.financial",name:"财务",icon:"emweb web-financial"}]),e.$on("$stateChangeSuccess",function(e,t,a,o,r){i.menuData.active=t.name}),void(EMAPP.User.token?(t.prev.exist=!1,angular.forEach(i.menuData,function(e){t.prev.state&&~t.prev.state.indexOf(e.state)&&(t.prev.exist=!0)}),t.go(t.prev.exist&&t.prev.state||"dashboard.main",t.prev.params)):t.go("auth",{action:"login"}))):void delete sessionStorage.projectid})}]);
//# sourceMappingURL=dashboard.min.js.map
