"use strict";angular.module("app").controller("CollectorIndex",["$rootScope","$scope","$api","$uibModal","SweetAlert",function(o,i,l,e,c){i.currentPage=1,i.askingRemoveID=void 0,i.DoRemove=function(t,e,n){t.preventDefault(),l.collector.delete({id:e},function(){i.items.detail.splice(n,1)},c.error)},i.AskForRemove=function(t,e){t.preventDefault(),i.askingRemoveID=e},i.CancelRemove=function(t){t.preventDefault(),i.askingRemoveID=void 0},i.switchStatus=function(n,t){t.preventDefault(),e.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(t,e){t.item=angular.copy(n),t.ok=function(){l.collector.status({id:n.id,projectid:o.Project.current._id,status:"ONLINE"==n.status?"DEBUG":"ONLINE"},function(){n.status="ONLINE"==t.item.status?"DEBUG":"ONLINE",e.dismiss("cancel")},function(){e.dismiss("cancel")})},t.cancel=function(){e.dismiss("cancel")}}]})},i.multiCheck=function(t){"all"===t?(i.multiCheck.all&&(i.showButton=!0),!i.multiCheck.all&&(i.showButton=!1),angular.forEach(i.items.detail,function(t){t.isSelected=i.multiCheck.all})):(i.multiCheck.all=!0,i.showButton=!1,angular.forEach(i.items.detail,function(t){t.isSelected||delete i.multiCheck.all,t.isSelected&&(i.showButton=!0)}))},i.multiIds=function(){var e=[];return angular.forEach(i.items.detail,function(t){t.isSelected&&e.push(t.id)}),e},i.switchAll=function(n,t){t.preventDefault();var c=i;e.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(t,e){t.ok=function(){l.collector.status({id:c.multiIds(),projectid:o.Project.current._id,status:n},function(){l.collector.info({project:o.Project.current._id},function(t){delete c.multiCheck.all,c.items=t.result,e.dismiss("cancel")})},function(){e.dismiss("cancel")})},t.cancel=function(){e.dismiss("cancel")}}]})},i.popIsOpen=function(){angular.forEach(i.items.detail,function(t){delete t.titleIsOpen})},i.popover={url:{title:"titleChange.html"},title:{title:"管理器名称修改"},ok:function(t,e,n){t[e+"IsOpen"]=!1,i.item=angular.copy(t),i.item[e]=n[e],l.collector.update(i.item,function(){t[e]=n[e],c.success("更新成功")},c.error)},cancel:function(t,e){t[e+"IsOpen"]=!1}},i.$watch("currentPage",function(){l.collector.info({project:o.Project.current._id,pageindex:i.currentPage,pagesize:20},function(t){i.items=t.result},function(){delete i.items})})}]);