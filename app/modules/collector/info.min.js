"use strict";angular.module("app").controller("CollectorIndex",["$rootScope","$scope","$api","$uibModal","SweetAlert",function(t,e,n,c,o){e.currentPage=1,e.askingRemoveID=void 0,e.DoRemove=function(t,c,i){t.preventDefault(),n.collector.delete({id:c},function(){e.items.detail.splice(i,1)},o.error)},e.AskForRemove=function(t,n){t.preventDefault(),e.askingRemoveID=n},e.CancelRemove=function(t){t.preventDefault(),e.askingRemoveID=void 0},e.switchStatus=function(e,o){o.preventDefault(),c.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(c,o){c.item=angular.copy(e),c.ok=function(){n.collector.status({id:e.id,projectid:t.Project.current._id,status:"ONLINE"==e.status&&"DEBUG"||"ONLINE"},function(){e.status="ONLINE"==c.item.status&&"DEBUG"||"ONLINE",o.dismiss("cancel")},function(){o.dismiss("cancel")})},c.cancel=function(){o.dismiss("cancel")}}]})},e.multiCheck=function(t){"all"===t?(e.multiCheck.all&&(e.showButton=!0),!e.multiCheck.all&&(e.showButton=!1),angular.forEach(e.items.detail,function(t){t.isSelected=e.multiCheck.all})):(e.multiCheck.all=!0,e.showButton=!1,angular.forEach(e.items.detail,function(t){t.isSelected||delete e.multiCheck.all,t.isSelected&&(e.showButton=!0)}))},e.multiIds=function(){var t=[];return angular.forEach(e.items.detail,function(e){e.isSelected&&t.push(e.id)}),t},e.switchAll=function(o,i){i.preventDefault();var l=e;c.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(e,c){e.ok=function(){n.collector.status({id:l.multiIds(),projectid:t.Project.current._id,status:o},function(){n.collector.info({project:t.Project.current._id},function(t){delete l.multiCheck.all,l.items=t.result,c.dismiss("cancel")})},function(){c.dismiss("cancel")})},e.cancel=function(){c.dismiss("cancel")}}]})},e.popIsOpen=function(){angular.forEach(e.items.detail,function(t){delete t.titleIsOpen})},e.popover={url:{title:"titleChange.html"},title:{title:"管理器名称修改"},ok:function(t,c,i){t[c+"IsOpen"]=!1,e.item=angular.copy(t),e.item[c]=i[c],n.collector.update(e.item,function(){t[c]=i[c],o.success("更新成功")},o.error)},cancel:function(t,e){t[e+"IsOpen"]=!1}},e.$watch("currentPage",function(){n.collector.info({project:t.Project.current._id,pageindex:e.currentPage,pagesize:20},function(t){e.items=t.result},function(){delete e.items})})}]);