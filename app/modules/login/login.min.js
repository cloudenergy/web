"use strict";angular.module("app").component("login",{templateUrl:"app/modules/login/login.html?rev=a2af016ee1",controller:["$scope","$cookies","$element","$timeout","$state","User","SweetAlert",function(e,o,r,l,a,t,c){var s=this,n=/cloudenergy\.me/.test(location.hostname)?/^(\w+)\./.exec(location.hostname)[1].toLowerCase():"www",m={www:{src:"app/modules/login/img/logo.png?rev=b0dcbb2509",title:"古鸽智慧云能源"}};s.logoSrc=m[n]&&m[n].src||m.www.src,s.logoTitle=m[n]&&m[n].title||m.www.title,s.user=localStorage.loginUser,s.passwd=localStorage.loginPasswd,s.remember=!!localStorage.loginRemember,s.rememberaccount=!!localStorage.rememberAccount,s.readonly=!0,l(function(){s.readonly=!1},500),r.find("input[type=checkbox]").radiocheck(),s.clearUserInput=function(){delete localStorage.loginUser,delete s.user,delete localStorage.loginPasswd,delete s.passwd,delete localStorage.loginRemember,delete s.remember,delete localStorage.rememberAccount,delete s.rememberaccount},s.clearPasswdInput=function(){delete localStorage.loginPasswd,delete s.passwd,delete localStorage.loginRemember,delete s.remember},e.$watch("$ctrl.rememberaccount",function(){!s.rememberaccount&&(s.remember=s.rememberaccount)}),e.$watch("$ctrl.remember",function(){s.remember&&(s.rememberaccount=s.remember)}),s.login=function(e){var o=s.remember,r=s.rememberaccount;e.$invalid?(!s.user&&e.user.$setDirty(),!s.passwd&&e.password.$setDirty()):(delete localStorage.loginUser,delete localStorage.loginPasswd,delete localStorage.loginRemember,delete localStorage.rememberAccount,localStorage.loginUser=s.user,o&&(localStorage.loginPasswd=s.passwd,localStorage.loginRemember=o,localStorage.rememberAccount=r,localStorage.loginUser=s.user),!o&&r&&(delete localStorage.loginPasswd,delete localStorage.loginRemember,localStorage.rememberAccount=r,localStorage.loginUser=s.user),t.$login({user:s.user,passwd:(new window.Hashes.MD5).hex(s.passwd).toUpperCase(),remember:o}).then(function(){a.go("dashboard.main",{},{location:"replace"})},function(e){e.message={20000001:"用户不存在",90000001:"服务器错误",90000002:"拒绝访问",90000003:"登录失败",90000004:"权限不足",90000005:"未登录",90000006:["验证失败","账号或密码有误"],90000007:"签名校验失败"}[e.code]||e.message,e.message&&c.error.apply(c,angular.isArray(e.message)?e.message:[e.message])}))}}]});