"use strict";angular.module("app").component("login",{templateUrl:"app/modules/login/login.html?rev=c4b3cd06ee",controller:["$scope","$cookies","$element","$timeout","$state","User","SweetAlert",function(e,o,r,l,a,t,c){var n=this,s=/cloudenergy\.me/.test(location.hostname)?/^(\w+)\./.exec(location.hostname)[1].toLowerCase():"www",m={www:{src:"app/modules/login/img/logo.png?rev=b0dcbb2509",title:"智慧云能源用户平台"},basic:{src:"app/modules/login/img/logo_basic.png?rev=dfa0152ed7",title:"柏诚智能云能源用户平台"},intel:{src:"app/modules/login/img/logo_hongzhi.png?rev=22cdae43dc",title:"鸿智途源云能源用户平台"}};n.logoSrc=m[s]&&m[s].src||m.www.src,n.logoTitle=m[s]&&m[s].title||m.www.title,n.user=localStorage.loginUser,n.passwd=localStorage.loginPasswd,n.remember=!!localStorage.loginRemember,n.rememberaccount=!!localStorage.rememberAccount,n.readonly=!0,l(function(){n.readonly=!1},500),r.find("input[type=checkbox]").radiocheck(),n.clearUserInput=function(){delete localStorage.loginUser,delete n.user,delete localStorage.loginPasswd,delete n.passwd,delete localStorage.loginRemember,delete n.remember,delete localStorage.rememberAccount,delete n.rememberaccount},n.clearPasswdInput=function(){delete localStorage.loginPasswd,delete n.passwd,delete localStorage.loginRemember,delete n.remember},e.$watch("$ctrl.rememberaccount",function(){n.rememberaccount||(n.remember=n.rememberaccount)}),e.$watch("$ctrl.remember",function(){n.remember&&(n.rememberaccount=n.remember)}),n.login=function(e){var o=n.remember,r=n.rememberaccount;e.$invalid?(!n.user&&e.user.$setDirty(),!n.passwd&&e.password.$setDirty()):(delete localStorage.loginUser,delete localStorage.loginPasswd,delete localStorage.loginRemember,delete localStorage.rememberAccount,localStorage.loginUser=n.user,o&&(localStorage.loginPasswd=n.passwd,localStorage.loginRemember=o,localStorage.rememberAccount=r,localStorage.loginUser=n.user),!o&&r&&(delete localStorage.loginPasswd,delete localStorage.loginRemember,localStorage.rememberAccount=r,localStorage.loginUser=n.user),t.$login({user:n.user,passwd:(new window.Hashes.MD5).hex(n.passwd).toUpperCase(),remember:o}).then(function(){a.go("dashboard.main",{},{location:"replace"})},function(e){angular.forEach({20000001:"用户不存在",90000001:"服务器错误",90000002:"拒绝访问",90000003:"登录失败",90000004:"权限不足",90000005:"未登录",90000006:["验证失败","账号或密码有误"],90000007:"签名校验失败"},function(o,r){parseInt(e.code)===parseInt(r)&&(e.message=o)}),e.message&&c.error.apply(c,angular.isArray(e.message)?e.message:[e.message])}))}}]});