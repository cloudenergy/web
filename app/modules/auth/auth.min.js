angular.module("app").component("auth",{templateUrl:"app/modules/auth/auth.html?rev=0851797c76",controller:["$scope","$cookies","$element","$timeout","$state","$stateParams","User","md5","SweetAlert",function(e,o,a,t,r,l,s,n,i){var g=this,c=l.action||"logout",d=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,m=/cloudenergy\.me/.test(location.hostname)?/^(\w+)\./.exec(location.hostname)[1].toLowerCase():"www",u={www:{src:"app/modules/auth/img/logo.png?rev=b0dcbb2509",title:"智慧云能源用户平台"},basic:{src:"app/modules/auth/img/logo_basic.png?rev=dfa0152ed7",title:"柏诚智能云能源用户平台"},intel:{src:"app/modules/auth/img/logo_hongzhi.png?rev=22cdae43dc",title:"鸿智途源云能源用户平台"}};g.logoSrc=u[m].src,g.logoTitle=u[m].title,g.user=localStorage.loginUser,g.passwd=localStorage.loginPasswd,g.remember=!!localStorage.loginRemember,g.readonly=!0,t(function(){g.readonly=!1},500),a.find("input[name=remember]").radiocheck(),g.clearUserInput=function(){delete localStorage.loginUser,delete g.user,delete localStorage.loginPasswd,delete g.passwd,delete localStorage.loginRemember,delete g.remember},g.clearPasswdInput=function(){delete localStorage.loginPasswd,delete g.passwd,delete localStorage.loginRemember,delete g.remember},g.login=function(e){var a=g.remember;e.$invalid?(!g.user&&e.user.$setDirty(),!g.passwd&&e.password.$setDirty()):(delete localStorage.loginUser,delete localStorage.loginPasswd,delete localStorage.loginRemember,localStorage.loginUser=g.user,a&&(localStorage.loginPasswd=g.passwd,localStorage.loginRemember=a),s.login({user:g.user,passwd:n.createHash(g.passwd).toUpperCase()}).then(function(e){angular.forEach(["token","uid","user"],function(e){APP.User[e]&&o.put(e,APP.User[e]||!1,{path:"/",domain:d,expires:a&&moment().add(1,"months")._d||void 0})}),r.go(r.prev.state||"dashboard.main",APP.User.groupmode&&r.prev.params||{})},function(e){angular.forEach({20000001:"用户不存在",90000001:"服务器错误",90000002:"拒绝访问",90000003:"登录失败",90000004:"权限不足",90000005:"未登录",90000006:["验证失败","账号或密码有误"],90000007:"签名校验失败"},function(o,a){parseInt(e.code)===parseInt(a)&&(e.message=o)}),e.message&&i.error.apply(i,angular.isArray(e.message)?e.message:[e.message])}))},"logout"===c&&s.logout({redirect:"/"}).then(function(){angular.forEach(["token","uid","user"],function(e){o.remove(e,{path:"/",domain:".www"+d}),o.remove(e,{path:"/",domain:d}),o.remove(e,{path:"/"})}),r.go("auth",{action:"login"})})}]});