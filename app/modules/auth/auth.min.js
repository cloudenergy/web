angular.module("app").component("auth",{templateUrl:"app/modules/auth/auth.html?rev=f22832f774",controller:["$scope","$cookies","$element","$timeout","$state","$stateParams","User","md5","SweetAlert",function(e,o,a,t,r,l,s,n,i){var m=this,d=l.action||"logout",g=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname;m.isBasic=/^basic\./.test(location.host),m.user=localStorage.loginUser,m.passwd=localStorage.loginPasswd,m.remember=!!localStorage.loginRemember,m.readonly=!0,t(function(){m.readonly=!1},500),a.find("input[name=remember]").radiocheck(),m.clearUserInput=function(){delete localStorage.loginUser,delete m.user,delete localStorage.loginPasswd,delete m.passwd,delete localStorage.loginRemember,delete m.remember},m.clearPasswdInput=function(){delete localStorage.loginPasswd,delete m.passwd,delete localStorage.loginRemember,delete m.remember},m.login=function(e){var a=m.remember;e.$invalid?(!m.user&&e.user.$setDirty(),!m.passwd&&e.password.$setDirty()):(delete localStorage.loginUser,delete localStorage.loginPasswd,delete localStorage.loginRemember,localStorage.loginUser=m.user,a&&(localStorage.loginPasswd=m.passwd,localStorage.loginRemember=a),s.login({user:m.user,passwd:n.createHash(m.passwd).toUpperCase()}).then(function(e){angular.forEach(["token","user"],function(e){APP.User[e]&&o.put(e,APP.User[e]||!1,{path:"/",domain:g,expires:a&&moment().add(1,"months")._d||void 0})}),r.go(r.prev.state||"dashboard.main",APP.User.groupmode&&r.prev.params||{})},function(e){angular.forEach({20000001:"用户不存在",90000001:"服务器错误",90000002:"拒绝访问",90000003:"登录失败",90000004:"权限不足",90000005:"未登录",90000006:["验证失败","账号或密码有误"],90000007:"签名校验失败"},function(o,a){parseInt(e.code)===parseInt(a)&&(e.message=o)}),e.message&&i.error.apply(i,angular.isArray(e.message)?e.message:[e.message])}))},"logout"===d&&s.logout({redirect:"/"}).then(function(){angular.forEach(["token","user"],function(e){o.remove(e,{path:"/"}),o.remove(e,{path:"/",domain:g}),o.remove(e,{path:"/",domain:".www"+g})}),r.go("auth",{action:"login"})})}]});