"use strict";angular.module("app").component("monitor",{templateUrl:"app/modules/monitor/monitor.html?rev=10119478f6",controller:["$rootScope","$scope","$element","$q","$api","$timeout","SweetAlert","monitorBatchControl","monitorColumnGroupmode","monitorColumnTIMERMETER",function(e,t,l,n,i,a,s,c,d,o){var r=this,p=sessionStorage.projectid,m=function(e,t,l){if(angular.isObject(e)&&!angular.isArray(e)){var n,i=[];return e.entity&&(n=e.entity.status[l]),e.entity&&(e.entity.status["prev_"+l]=void 0),angular.forEach(r.gridApi.grid.rows,function(a){!e.entity.id&&a.isSelected&&a.entity.command[t]&&(e.entity&&a.entity.id!==e.entity.id&&(a.entity.status["prev_"+l]=a.entity.status[l],a.entity.status[l]=n),i.push(a.entity.id))}),i.length?(e.entity.id&&!e.isSelected&&(e.isSelected=!0,i.push(e.entity.id)),r.multiCheck()):e.entity.id&&i.push(e.entity.id),i}angular.forEach(r.gridApi.grid.rows,function(t){~e.indexOf(t.entity.id)&&(t.entity.status[l]=t.entity.status["prev_"+l],delete t.entity.status["prev_"+l])})};r.show="meter",r.isHide=!0,r.date=moment().format("YYYY-MM"),r.isHide=!0,r.itemSelected=!1,r.multiCheck=function(e){if("all"===e)r.multiCheck.all&&(r.itemSelected=!0),!r.multiCheck.all&&(r.itemSelected=!1),angular.forEach(r.gridApi.grid.rows,function(e){e.isSelected=r.multiCheck.all}),r.selectedItemLength=r.gridOptions.data.length;else{var t=[];r.multiCheck.all=!0,r.itemSelected=!1,angular.forEach(r.gridApi.grid.rows,function(e){e.isSelected||delete r.multiCheck.all,e.isSelected&&(t.push(e),r.itemSelected=!0)}),r.selectedItemLength=t.length}r.allItems=r.gridApi.grid.rows},r.batchControl=c,r.showException=!1,r.exceptionChange=function(){r.deviceType.select(r.deviceType.selected)},r.export=function(){r.gridOptions.exporterCsvFilename=document.title+"_监控_"+r.deviceType.selected.name+"_"+moment().format("YYYYMMDDHHmmss")+".csv",r.gridApi.exporter.csvExport("visible","visible",angular.element(document.querySelectorAll(".subContent")))},r.gridOptions={onRegisterApi:function(e){e.infiniteScroll.on.needLoadMoreData(t,function(){var t=n.defer(),l=function(){t.resolve()},i=function(){e.infiniteScroll.dataLoaded(),t.reject()};return function(t){t?t.then(function(){e.infiniteScroll.saveScrollPercentage(),e.infiniteScroll.dataLoaded(!1,!0).then(l,i)},i):i()}(r.list(!0)),t.promise}),r.gridApi=e},rowHeight:34,infiniteScrollDown:!0,enableColumnMenus:!1,enableColumnResizing:!0,exporterOlderExcelCompatibility:!0,exporterFieldCallback:function(e,t,l,n){return{name:!0,addr:!0,title:!0,time:!0}[l.field]?'="'+(n||"")+'"':n}},r.electrOptions={onRegisterApi:function(e){r.gridApi=e},rowHeight:34,infiniteScrollDown:!0,enableColumnMenus:!1,enableColumnResizing:!0},r.electrOptions.columnDefs=[{displayName:"级别",name:"lv",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents">级别</div>'},{displayName:"一月",name:"month1",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">一月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"二月",name:"month2",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">二月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"三月",name:"month3",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">三月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"四月",name:"month4",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">四月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"五月",name:"month5",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">五月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"六月",name:"month6",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">六月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"七月",name:"month7",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">七月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"八月",name:"month8",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">八月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"九月",name:"month9",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">九月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"十月",name:"month10",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">十月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"十一月",name:"month11",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">十一月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'},{displayName:"十二月",name:"month12",minWidth:60,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><div style="text-align:center;border-bottom:1px solid #d4d4d4">十二月</div><div><span class="electrihead">用量</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">差额</span></div></div>',cellTemplate:'<div class="ui-grid-cell-contents"><span class="electrihead">{{COL_FIELD.use}}</span><span class="electrihead" style="border-left: 1px solid #d4d4d4;">{{COL_FIELD.balance}}</span></div>'}],r.columnDefsData=function(e){r.deviceType&&("ELECTRICITYMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:45,minWidth:45,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:290,pinnedLeft:!0,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">智能仪表名称</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div>',enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['11'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['11'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"控制",name:"status_switch1",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">开关</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOn,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关"">开</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOff,\'EMC_SWITCH\',\'switch\',\'mode\')">关</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.switch" state-on="EMC_ON" state-off="EMC_OFF" disabled="!row.entity.command.EMC_SWITCH" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关" data-on-color="primary"></switch></div>'},{displayName:"通道名称",name:"channels['11'].channel",width:"*",minWidth:80,enableColumnMenu:!1,enableSorting:!1},{displayName:"当前读数",name:"channels['11'].realdata",type:"number",width:"*",minWidth:120,headerCellClass:"text-right",cellClass:"text-right",cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'11\'" ng-bind="COL_FIELD"></a></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"HOTWATERMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:290,pinnedLeft:!0,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">智能仪表名称</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div>',enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['03'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['03'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"控制",name:"status_switch2",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">开关</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOn,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关"">开</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOff,\'EMC_SWITCH\',\'switch\',\'mode\')">关</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.switch" state-on="EMC_ON" state-off="EMC_OFF" disabled="!row.entity.command.EMC_SWITCH" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关" data-on-color="primary"></switch></div>'},{displayName:"通道名称",name:"channels['03'].channel",width:"*",minWidth:80,enableColumnMenu:!1,enableSorting:!1},{displayName:"当前读数",name:"channels['03'].realdata",type:"number",width:"*",minWidth:120,headerCellClass:"text-right",cellClass:"text-right",cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'03\'" ng-bind="COL_FIELD"></a></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"COLDWATERMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:150,pinnedLeft:!0,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">智能仪表名称</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div>',enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['01'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['01'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"控制",name:"status_switch3",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">开关</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOn,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关"">开</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOff,\'EMC_SWITCH\',\'switch\',\'mode\')">关</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.switch" state-on="EMC_ON" state-off="EMC_OFF" disabled="!row.entity.command.EMC_SWITCH" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关" data-on-color="primary"></switch></div>'},{displayName:"通道名称",name:"channels['01'].channel",width:"*",minWidth:80,enableColumnMenu:!1,enableSorting:!1},{displayName:"当前读数",name:"channels['01'].realdata",type:"number",width:"*",minWidth:120,headerCellClass:"text-right",cellClass:"text-right",cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'01\'" ng-bind="COL_FIELD"></a></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"ENERGYMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"序号",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:150,pinnedLeft:!0,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected" ng-bind="col.displayName"></div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div>',enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",type:"string",name:"addrid",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"模式",name:"status_mode04",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">模式</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.cool,\'EMC_MODE\',\'mode\',\'mode\')">制冷</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.heat,\'EMC_MODE\',\'mode\',\'mode\')">制热</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.mode" state-on="EMC_COOLING" state-off="EMC_HEATING" disabled="!row.entity.command.EMC_MODE" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_MODE\',\'mode\',\'mode\')" data-on-text="制冷" data-off-text="制热" data-on-color="info" data-off-color="danger"></switch></div>'},{displayName:"供水温度℃",type:"number",name:"channels_040",minWidth:100,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'05\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'05\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"回水温度 ℃",type:"number",name:"channels_041",minWidth:100,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'06\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'06\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"温差 ℃",type:"number",name:"channels_042",minWidth:100,enableSorting:!1,enableColumnMenu:!1,cellTemplate:"<div class=\"ui-grid-cell-contents\"><div class=\"form-group form-group-sm has-feedback\" ng-class=\"{'focus':row.entity.channels['05']}\"><span class=\"form-control text-right\" ng-bind=\"(row.entity.channels['05'].lasttotal>row.entity.channels['06'].lasttotal?row.entity.channels['05'].lasttotal-row.entity.channels['06'].lasttotal:row.entity.channels['06'].lasttotal-row.entity.channels['05'].lasttotal).toFixed(2)\"></span><span class=\"form-control-feedback\"></span></div></div>"},{displayName:"流量 m3",type:"number",name:"channels_043",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'04\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'04\'].lasttotal"></span></div></div>'},{displayName:"流速 m3/s",type:"number",name:"channels_044",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'09\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'09\'].lasttotal"></span></div></div>'},{displayName:"总冷量(KWh)",type:"number",name:"channels_045",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback pointer" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'07\'" ng-class="{\'focus\':!row.entity.nocold}"><span class="form-control text-right" ng-bind="row.entity.channels[\'07\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"总热量(KWh)",type:"number",name:"channels_046",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback pointer" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'08\'" ng-class="{\'focus\':!row.entity.noheat}"><span class="form-control text-right" ng-bind="row.entity.channels[\'08\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"发送",name:"send",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">发送</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected"><a href="javascript:void(0)" class="btn btn-sm btn-info" ng-click="grid.appScope.$ctrl.commandSend()">发送 <i class="glyphicon glyphicon-send"></i></a></div>',cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" class="btn btn-sm btn-info" ng-click="grid.appScope.$ctrl.commandSend(row)">发送 <i class="glyphicon glyphicon-send"></i></a></div>'},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"TEMPERATURECONTROL"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:150,pinnedLeft:!0,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><span ng-show="!grid.appScope.$ctrl.itemSelected" ng-bind="col.displayName"></span><div ng-show="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div></div>',enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['33'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['33'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"面板开关",name:"status_switch5",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">面板开关</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOn,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关"">开</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.turnOff,\'EMC_SWITCH\',\'switch\',\'mode\')">关</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.switch" state-on="EMC_ON" state-off="EMC_OFF" disabled="!row.entity.command.EMC_SWITCH" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_SWITCH\',\'switch\',\'mode\')" data-on-text="开" data-off-text="关" data-on-color="primary"></switch></div>'},{displayName:"阀控开关",name:"status_valve5",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" style="height:40px;" ng-if="!grid.appScope.$ctrl.itemSelected">阀控开关</div><div class="ui-grid-cell-contents" style="height:40px;" ng-if="grid.appScope.$ctrl.itemSelected"><button class="btn btn-xs btn-info ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.on,\'EMC_VALVE\',\'valve\',\'mode\')" data-on-text="开" data-off-text="关"">开</button><button class="btn btn-xs btn-danger ml5" ng-click="grid.appScope.$ctrl.confirmControl(grid.appScope.$ctrl.batchControl.off,\'EMC_VALVE\',\'valve\',\'mode\')">关</button></div>',cellTemplate:'<div class="ui-grid-cell-contents"><switch class="bootstrap-switch-square mt3" state="row.entity.status.valve" state-on="EMC_ON" state-off="EMC_OFF" disabled="!row.entity.command.EMC_VALVE" on-switch="grid.appScope.$ctrl.confirmControl(row,\'EMC_VALVE\',\'valve\',\'mode\')" data-on-text="开" data-off-text="关" data-on-color="primary"></switch></div>'},{displayName:"模式",name:"status_mode5",minWidth:300,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">模式</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected"><control-mode class="btn-group" ng-if="grid.appScope.$ctrl.itemSelected" mode="grid.appScope.$ctrl.batchControl.mode.entity.status.mode" on-mode="grid.appScope.$ctrl.multiControl(grid.appScope.$ctrl.batchControl.mode,\'EMC_MODE\',\'mode\',\'mode\')"></control-mode></div>',cellTemplate:'<div class="ui-grid-cell-contents"><control-mode class="btn-group" mode="row.entity.status.mode" disabled="!row.entity.command.EMC_MODE" on-mode="grid.appScope.$ctrl.multiControl(row,\'EMC_MODE\',\'mode\',\'mode\')"></control-mode></div>'},{displayName:"风速",name:"status_windspeed5",minWidth:130,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">风速</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected"><control-speed speed="grid.appScope.$ctrl.batchControl.windspeed.entity.status.windspeed" on-speed="grid.appScope.$ctrl.multiControl(grid.appScope.$ctrl.batchControl.windspeed,\'EMC_WINDSPEED\',\'windspeed\',\'mode\')"></control-speed></div>',cellTemplate:'<div class="ui-grid-cell-contents"><control-speed speed="row.entity.status.windspeed" disabled="!row.entity.command.EMC_WINDSPEED" on-speed="grid.appScope.$ctrl.multiControl(row,\'EMC_WINDSPEED\',\'windspeed\',\'mode\')"></control-speed></div>'},{displayName:"设置温度",name:"channels_050",minWidth:220,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">设置温度</div><div class="ui-grid-cell-contents pl10 pr10" ng-if="grid.appScope.$ctrl.itemSelected"><control-slider value="grid.appScope.$ctrl.batchControl.temperature.entity.status.temperature" on-slider="grid.appScope.$ctrl.multiControl(grid.appScope.$ctrl.batchControl.temperature,\'EMC_TEMPERATURE\',\'temperature\',\'value\')"></control-slider></div>',cellTemplate:'<div class="ui-grid-cell-contents pl10 pr10"><control-slider value="row.entity.status.temperature" disabled="!row.entity.command.EMC_TEMPERATURE" on-slider="grid.appScope.$ctrl.multiControl(row,\'EMC_TEMPERATURE\',\'temperature\',\'value\')"></control-slider></div>'},{displayName:"室内温度℃",type:"number",name:"channels_051",minWidth:100,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="row.entity.status.inroomtemperature||row.entity.channels[\'40\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"能量系数",type:"number",name:"channels_052",minWidth:140,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="input-group input-group-sm focus pointer" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'33\'"><span class="input-group-addon"><i class="emweb web-charging"></i></span><span class="form-control" ng-bind="row.entity.channels[\'33\'].lasttotal"></span></div></div>'},{displayName:"发送",name:"send",minWidth:100,enableSorting:!1,enableColumnMenu:!1,headerCellTemplate:'<div class="ui-grid-cell-contents" ng-if="!grid.appScope.$ctrl.itemSelected">发送</div><div class="ui-grid-cell-contents" ng-if="grid.appScope.$ctrl.itemSelected"><a href="javascript:void(0)" class="btn btn-sm btn-info" ng-click="grid.appScope.$ctrl.commandSend()">发送 <i class="glyphicon glyphicon-send"></i></a></div>',cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" class="btn btn-sm btn-info" ng-click="grid.appScope.$ctrl.commandSend(row)">发送 <i class="glyphicon glyphicon-send"></i></a></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"TIMERMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=o):"ULTRACOLDWATERMETER"===r.deviceType.selected.id?(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:150,pinnedLeft:!0,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><span ng-show="!grid.appScope.$ctrl.itemSelected" ng-bind="col.displayName"></span><div ng-show="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div></div>',enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['04'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['04'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"累计流量m³",type:"number",name:"channels_043",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback pointer" ng-class="{\'focus\':row.entity.channels[\'04\']}" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'04\'"><span class="form-control text-right" ng-bind="row.entity.channels[\'04\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"流速m³/s",type:"number",name:"channels_044",minWidth:120,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'09\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'09\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"供水温度℃",type:"number",name:"channels_040",minWidth:100,enableSorting:!1,enableColumnMenu:!1,cellTemplate:'<div class="ui-grid-cell-contents"><div class="form-group form-group-sm has-feedback" ng-class="{\'focus\':row.entity.channels[\'05\']}"><span class="form-control text-right" ng-bind="row.entity.channels[\'05\'].lasttotal"></span><span class="form-control-feedback"></span></div></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90},{displayName:"关联商户",type:"number",name:"department[0].title",width:"*",minWidth:150},{displayName:"商户账号",type:"number",name:"department[0].account",width:"*",minWidth:150}]):"PRESSUREMETER"===r.deviceType.selected.id&&(r.gridOptions.rowHeight=45,r.gridOptions.columnDefs=[{displayName:"",name:"multiCheck",width:36,minWidth:36,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="grid.appScope.$ctrl.multiCheck.all" on-check="grid.appScope.$ctrl.multiCheck(\'all\')"></checkbox></div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents"><checkbox checked="row.isSelected" on-check="grid.appScope.$ctrl.multiCheck()"></checkbox></div>'},{displayName:"",name:"$index",type:"number",width:50,minWidth:50,pinnedLeft:!0,enableColumnMenu:!1,exporterSuppressExport:!0,headerCellClass:"text-center",headerCellTemplate:'<div class="ui-grid-cell-contents">序号</div>',cellClass:"text-center pt5",cellTemplate:'<div class="ui-grid-cell-contents" ng-bind="grid.renderContainers.body.visibleRowCache.indexOf(row)+1"></div>'},{displayName:"智能仪表名称",name:"title",minWidth:150,pinnedLeft:!0,enableColumnMenu:!0,headerCellTemplate:'<div class="ui-grid-cell-contents"><span ng-show="!grid.appScope.$ctrl.itemSelected" ng-bind="col.displayName"></span><div ng-show="grid.appScope.$ctrl.itemSelected">批量控制:已选<span class="text-danger">{{grid.appScope.$ctrl.selectedItemLength}}</span>个</div></div>',enableSorting:!0,cellClass:"pt5"},{displayName:"智能仪表ID",name:"addrid",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"状态",name:"channels['10'].status",width:"*",minWidth:70,enableColumnMenu:!1,enableSorting:!1,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:function(){return['<div class="ui-grid-cell-contents">','<b ng-show="COL_FIELD===0" class="ng-hide" style="color:#16a085;">正常</b>','<b ng-show="COL_FIELD===1" class="ng-hide" style="color:#c0392b;">数据异常</b>','<b ng-show="COL_FIELD===2" class="ng-hide" style="color:#8e44ad;">通讯异常</b>',"</div>"].join("")}},{displayName:"通讯时间",name:"channels['10'].lastupdate",width:"*",minWidth:180,headerCellClass:"text-center",cellClass:"text-center",cellTemplate:'<div class="ui-grid-cell-contents" ng-if="COL_FIELD">{{COL_FIELD|date:\'yyyy年M月dd日 H:mm:ss\'}}</div>'},{displayName:"当前读数",name:"channels[10].lasttotal",width:"*",minWidth:140,cellTemplate:'<div class="ui-grid-cell-contents"><a href="javascript:void(0)" ng-click="grid.appScope.$ctrl.realData=row.entity;row.entity.currentchannelid=\'10\'" ng-bind="COL_FIELD"></a></div>'},{displayName:"位置编码",name:"tag",width:"*",minWidth:140},{displayName:"采集器编号",type:"number",name:"gatewayid",width:"*",minWidth:90}])),"electricnet"==e?r.electrOptions.data=[{lv:"每月用电合计",month1:{use:73980,balance:1782},month2:{use:60593,balance:13423},month3:{use:71560,balance:11374},month4:{use:73652,balance:2678},month5:{use:94207,balance:21732},month6:{use:99090,balance:5894},month7:{use:125913,balance:26478},month8:{use:129960,balance:4783},month9:{use:112980,balance:17783},month10:{use:99840,balance:13723},month11:{use:78882,balance:21412},month12:{use:76696,balance:2245}}]:"waternet"==e&&(r.electrOptions.data=[{lv:"每月总用水量",month1:{use:19249,balance:1412},month2:{use:15086,balance:4243},month3:{use:16764,balance:1712},month4:{use:18636,balance:1973},month5:{use:25026,balance:5267},month6:{use:19249,balance:5267},month7:{use:25026,balance:5212},month8:{use:19249,balance:14846},month9:{use:19249,balance:0},month10:{use:25026,balance:5267},month11:{use:19249,balance:5267},month12:{use:15026,balance:445}}])},r.columnDefsData("electricnet"),p&&i.device.type({project:p},function(e){r.deviceType=[],angular.forEach(e.result,function(e){"ENERGYMETER"!==e.id&&"TEMPERATURECONTROL"!==e.id&&"TIMERMETER"!==e.id||r.deviceType.push(e)}),angular.forEach(e.result,function(e){"ENERGYMETER"!==e.id&&"TEMPERATURECONTROL"!==e.id&&"TIMERMETER"!==e.id&&r.deviceType.push(e)}),r.deviceType.length&&(r.deviceType.select=function(e){delete r.multiCheck.all,r.deviceType.selected=e,r.list()})(r.deviceType[0])}),p?t.$watch("$ctrl.customerSelected",function(){r.deviceType&&r.list()}):a(function(){r.list()}),r.list=function(e){if(e||(r.itemSelected=!1),!(e&&r.gridOptions.paging&&r.gridOptions.paging.count<=r.gridOptions.paging.pageindex*r.gridOptions.paging.pagesize))return r.deviceType&&r.deviceType.selected?(r._listRequest&&r._listRequest.$cancelRequest&&!r._listRequest.$resolved&&r._listRequest.$cancelRequest(),r._listRequest=i.business.monitor({devicetype:r.deviceType.selected.id,project:p,key:r.searchKey,ext:{enableMask:1},mode:"SENSOR",usesocity:r.customerSelected?1:void 0,socitynode:r.customerSelected,showexception:r.showException&&1||void 0,pageindex:(e&&r.gridOptions.paging?r.gridOptions.paging.pageindex:0)+1,pagesize:50},function(t){return t=t.result[p]||{},r.itemLength=t.paging.count,angular.forEach(t.detail,function(e){"TEMPERATURECONTROL"===r.deviceType.selected.id&&(e.status.temperature=e.status.temperature||e.channels[37]&&e.channels[37].lasttotal),angular.forEach(e.command,function(t){e.command[t]=t}),"ENERGYMETER"===r.deviceType.selected.id&&(e.channels["07"]&&0==e.channels["07"].status?(e.status=0,e.channels["08"]||(e.noheat=!0)):e.channels["08"]&&0==e.channels["08"].status?(e.status=0,e.channels["07"]||(e.nocold=!0)):e.channels["07"]&&!e.channels["08"]?(e.noheat=!0,e.status=e.channels["07"].status,e.lastupdate=e.channels["07"].lastupdate):!e.channels["07"]&&e.channels["08"]?(e.nocold=!0,e.status=e.channels["08"].status,e.lastupdate=e.channels["08"].lastupdate):e.channels["07"]&&e.channels["08"]?e.channels["07"].lastupdate>e.channels["08"].lastupdate?(e.status=e.channels["07"].status,e.lastupdate=e.channels["07"].lastupdate):(e.status=e.channels["08"].status,e.lastupdate=e.channels["08"].lastupdate):e.channels["07"]||e.channels["08"]||(e.nocold=!0,e.noheat=!0))}),e?r.gridOptions.data=r.gridOptions.data.concat(t.detail||[]):(r.gridOptions.data=t.detail||[],r.columnDefsData(),r.gridOptions.data.length&&a(function(){r.gridApi.core.scrollTo(r.gridOptions.data[0],r.gridOptions.columnDefs[0])})),r.gridOptions.paging=t.paging,r.multiCheck.all&&a(function(){r.multiCheck("all")}),r.columnDefsData(),t}),r._listRequest.$promise):void 0},t.$watch("$ctrl.customerSelected",function(){r.list()}),r.confirmControl=function(e,t,l,n){var i=m(e,t,l),a={};e.entity&&(a[n]=e.entity.status[l]),s.swal({title:"控制校验",input:"password",cancelButtonText:"取消",confirmButtonText:"确定",inputPlaceholder:"控制密码",showCancelButton:!0,showLoaderOnConfirm:!0,allowOutsideClick:!1,preConfirm:function(e){}}).then(function(){s.close()},function(){m(i,t,l)})},r.multiControl=function(e,t,l,n){m(e,t,l);({})[n]=e.entity.status[l]},r.commandSend=function(e){}}]}),angular.module("app").component("controlSlider",{templateUrl:"app/modules/monitor/slider.html?rev=adde9ad41f",bindings:{value:"=",disabled:"<",onSlider:"&"},controller:["$scope","$element",function(e,t){var l,n=this,i=t.children(".ui-slider"),a=angular.extend({min:15,max:30,orientation:"horizontal",range:"min"},t.data()),s=!1,c=function(e,t){n.value!==t.value&&(s=!0,l=n.value,n.value=t.value)},d=function(t,l){n.uivalue=l.value,e.$apply()};i.slider(a),angular.isDefined(a.disabled)&&i.slider("option","disabled",!!a.disabled),e.$watch("$ctrl.value",function(e){if(s)s=!1,n.onSlider();else if(angular.isUndefined(e)&&angular.isDefined(l))n.value=l,n.uivalue=l,l=void 0;else{angular.isDefined(e)&&e>a.max&&(e=Math.ceil(e%a.max)),n.uivalue=e||20;var t=i.slider("option","disabled");t&&i.slider("option","disabled",!1),i.off("slide"),i.off("slidechange"),i.slider("option","value",n.uivalue),i.on("slide",d),i.on("slidechange",c),t&&i.slider("option","disabled",!0)}}),n.$onChanges=function(e){angular.isUndefined(a.disabled)&&i.slider("option","disabled",!!e.disabled.currentValue)}}]}),angular.module("app").component("controlSpeed",{template:'<i class="emweb" ng-repeat="(key,val) in $ctrl.items" ng-class="[val,{active:$ctrl.speed===key}]" ng-click="$ctrl.click(key)"></i>',bindings:{speed:"=",disabled:"<",onSpeed:"&"},controller:["$scope",function(e){var t,l=this,n=!1;l.items={EMC_LOW:"web-speed-three",EMC_MEDIUM:"web-speed-four",EMC_HIGH:"web-speed-five"},l.click=function(e){l.disabled||(n=!0,t=l.speed,l.speed=e)},e.$watch("$ctrl.speed",function(e){l.disabled||(!0===n?(n=!1,l.onSpeed()):angular.isUndefined(e)&&angular.isDefined(t)?(l.speed=t,t=void 0):l.speed=e)})}]}),angular.module("app").component("controlMode",{template:'<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-repeat="(key,item) in $ctrl.items" ng-class="{active:$ctrl.mode===key}" ng-click="$ctrl.click(key)"><i class="emweb" ng-class="item.icon"></i>{{item.name}}</a>',bindings:{mode:"=",disabled:"<",onMode:"&"},controller:["$scope",function(e){var t,l=this,n=!1;l.items={EMC_COOLING:{icon:"web-snow",name:"制冷"},EMC_HEATING:{icon:"web-sun",name:"制热"},EMC_DEHUMIDIFYING:{icon:"web-clear-wet",name:"除湿"},EMC_VERTILATING:{icon:"web-ventilation",name:"通风"}},l.click=function(e){l.disabled||(n=!0,t=l.mode,l.mode=e)},e.$watch("$ctrl.mode",function(e){l.disabled||(!0===n?(n=!1,l.onMode()):angular.isUndefined(e)&&angular.isDefined(t)?(l.mode=t,t=void 0):l.mode=e)})}]}),angular.module("app").component("controlCommand",{templateUrl:"app/modules/monitor/command.html?rev=fa19bacbe1",bindings:{selected:"="},controller:["$scope","$element","$api","SweetAlert",function(e,t,l,n){var i,a=this,s=t.children(".modal");e.$watch("$ctrl.selected",function(t){t&&(a.formData={sensorid:t},s.modal("show"),i=e.form)}),a.submit=function(){},a.reset=function(){delete a.formData.command,delete a.formData.data},s.on("hidden.bs.modal",function(){return delete a.selected,delete a.formData,i.$setPristine(),e.$apply(),!1}),s.find("input[name=command]").on("invalid",function(){return i.command.$setDirty(),e.$apply(),!1}),s.find("input[name=data]").on("invalid",function(){return i.data.$setDirty(),e.$apply(),!1})}]}),angular.module("app").component("channeldetail",{templateUrl:"app/modules/monitor/channedetail.html?rev=a1f2725e06",bindings:{curve:"="},controller:["$scope","$element","$api","$timeout",function(e,t,l,n){var i=this,a=t.find(".modal-curve");a.on("shown.bs.modal",function(){n(i.buildLine)}).on("hidden.bs.modal",function(){delete i.curve,delete i.timeline}),e.$watch("$ctrl.curve",function(e){e&&i.channeldetail(e)}),i.date=moment().format("YYYY-MM-DD"),i.timetype={DAY:"日",WEEK:"周",MONTH:"月",YEAR:"年"},i.timetype_current="DAY",i.timetypeChange=function(e){i.timetype_current=e,t.find(".modal-curve input[datetimepicker]").data("DateTimePicker").format({DAY:"YYYY-MM-DD",WEEK:"YYYY-MM-DD",MONTH:"YYYY-MM",YEAR:"YYYY"}[e]).viewMode({DAY:"days",WEEK:"days",MONTH:"months",YEAR:"years"}[e]).defaultDate(i.date),i.channeldetail()},i.channeldetail=function(e){e&&(i.currentchannelid=e.currentchannelid),i.curve=e||i.curve||{},i.curve.type=i.curve.type||"diff",i.curve.categories=[],i.curve.diff=[],i.curve.scale=[],i.curve.enable=!1,i.channelID=[],i.charttype="spline";for(var t in i.curve.channels)i.channelID.push(t);i.curve.channels[i.currentchannelid]&&l.business.channeldetail({id:i.curve.channels[i.currentchannelid].id,timeformat:i.timetype_current,from:i.date.replace(/-/g,""),to:i.date.replace(/-/g,"")},function(e){e.result&&(angular.forEach(e.result.detail,function(e){i.curve.categories.push(e.timepoint),i.curve.diff.push(e.value),i.curve.scale.push(e.total)}),i.curve.enable=!0,i.curve.start=e.result.start,i.curve.unit=e.result.unit,a.hasClass("in")?i.buildLine():a.modal("show"))})},i.lineType=function(e){i.curve.type=e,i.buildLine()},i.typeChange=function(e){i.charttype=e,i.buildLine()},i.buildLine=function(){i.curve.enable&&(i.timeline={chart:{type:i.charttype},title:!1,xAxis:{type:"datetime",categories:i.curve.categories,labels:{formatter:function(){return moment(this.value).format({DAY:"H",WEEK:"M-DD",MONTH:"M-DD",YEAR:"YYYY-MM"}[i.timetype_current])}}},yAxis:{title:!1},tooltip:{xDateFormat:"%m月%d日",pointFormat:'{series.name}: <span style="color:{point.color};font-weight:700;">{point.y:.2f} '+i.curve.unit+"</span>"},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:.2f}"+i.curve.unit}}},series:[{name:i.curve.title,data:i.curve[i.curve.type]}]})}}]}),angular.module("app").component("pm",{templateUrl:"app/modules/monitor/pm.html?rev=d2efe2b6f1",controller:function(){var e=this;e.$onChanges=function(){e.pm={chart:{type:"spline"},title:!1,yAxis:{title:!1},xAxis:{categories:["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],crosshair:!0},series:[{name:"PM2.5",data:[63,71,68,56,70,67,71,68,76,77,70,63,71,68,56,70,67,71,68,76,77,70]}]}}}}),angular.module("app").component("pmDay",{templateUrl:"app/modules/monitor/pmday.html?rev=2ce16beeec",controller:["$ocLazyLoad",function(e){var t=this,l=e.load(["//cdn.bootcss.com/highcharts/5.0.12/highcharts-more.js"]);t.$onChanges=function(){l.then(function(){t.pm={chart:{type:"gauge",plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1},title:null,pane:{startAngle:-150,endAngle:150,background:[{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#333"]]},borderWidth:0,outerRadius:"109%"},{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#333"],[1,"#FFF"]]},borderWidth:1,outerRadius:"107%"},{},{backgroundColor:"#DDD",borderWidth:0,outerRadius:"105%",innerRadius:"103%"}]},yAxis:{min:0,max:500,minorTickInterval:"auto",minorTickWidth:1,minorTickLength:10,minorTickPosition:"inside",minorTickColor:"#666",tickPixelInterval:30,tickWidth:2,tickPosition:"inside",tickLength:10,tickColor:"#666",labels:{step:2,rotation:"auto"},title:null,plotBands:[{from:0,to:50,color:"#2CC767"},{from:50,to:100,color:"#E0B902"},{from:100,to:150,color:"#F08008"},{from:150,to:200,color:"#DB2D01"},{from:200,to:300,color:"#B007B7"},{from:300,to:500,color:"#620366"}]},series:[{name:null,data:[66],tooltip:null}]}})}}]}),angular.module("app").component("humiture",{templateUrl:"app/modules/monitor/humiture.html?rev=d2efe2b6f1",controller:function(){var e=this;e.$onChanges=function(){e.pm={chart:{type:"spline"},title:!1,xAxis:{categories:["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],crosshair:!0},yAxis:[{title:{text:null},labels:{align:"left",x:3,y:16,format:"{value:.,0f}"},showFirstLabel:!1},{linkedTo:0,gridLineWidth:0,opposite:!0,title:{text:null},labels:{align:"right",x:-3,y:16,format:"{value:.,0f}"},showFirstLabel:!1}],series:[{name:"湿度",type:"spline",data:[49.9,71.5,66.4,29.2,44,76,35.6,48.5,16.4,94.1,95.6,54.4],tooltip:{valueSuffix:"%"}},{name:"温度",type:"spline",data:[17,16.9,19.5,24.5,28.2,31.5,35.2,36.5,33.3,28.3,23.9,19.6],tooltip:{valueSuffix:"°C"}}]}}}});