EMAPP.templateCache.put("dist/html/project/control.min.html?rev=26403e5c7f",'<div class="app-view-project-control text-center ng-cloak"><div class="nav nav-tabs"><div class="btn-group"><a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:self.deviceType.selected.id===item.id}" ng-repeat="item in self.deviceType" ng-click="self.deviceType.select(item)" ng-bind="item.name"></a></div></div><div slimscroll=""><table class="table table-hover table-bordered" ng-repeat="(key,list) in self.monitorData"><tr ng-if="key===\'ENERGYMETER\'"><th style="width:15%;">传感器</th><th style="width:100px;">开关</th><th style="width:87px;">供水温度</th><th style="width:87px;">回水温度</th><th style="width:87px;">温差</th><th>流量</th><th>流速</th><th>总冷量</th><th>总热量</th></tr><tr ng-if="key===\'ENERGYMETER\'" ng-repeat="item in list"><td ng-bind="item.title"></td><td class="bootstrap-switch-square"><input type="checkbox" flat-switch="" data-on-color="info" data-on-text="制冷" data-on-value="EMC_COOLING" data-off-color="danger" data-off-text="制热" data-off-value="EMC_HEATING" data-command="{{(item.command|filter:\'EMC_MODE\').join()}}" data-sensorid="{{item.id}}" ng-checked="item.status.mode===\'EMC_COOLING\'"></td><td><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'05\'].lasttotal"></span> <span class="form-control-feedback"><i class="em em-degree"></i></span></div></td><td><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'06\'].lasttotal"></span> <span class="form-control-feedback"><i class="em em-degree"></i></span></div></td><td><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="(item.channels[\'05\'].lasttotal>item.channels[\'06\'].lasttotal?item.channels[\'05\'].lasttotal-item.channels[\'06\'].lasttotal:item.channels[\'06\'].lasttotal-item.channels[\'05\'].lasttotal).toFixed(2)"></span> <span class="form-control-feedback"><i class="em em-degree"></i></span></div></td><td><div class="form-group form-group-sm has-feedback"><span class="form-control text-right" ng-bind="item.channels[\'04\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td><td><div class="form-group form-group-sm has-feedback"><span class="form-control text-right" ng-bind="item.channels[\'09\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td><td><div class="form-group form-group-sm has-feedback"><span class="form-control text-right" ng-bind="item.channels[\'07\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td><td><div class="form-group form-group-sm has-feedback"><span class="form-control text-right" ng-bind="item.channels[\'08\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td></tr><tr ng-if="key===\'COLDWATERMETER\'"><th style="width:25%;">传感器</th><th style="width:100px;">开关</th><th style="text-align:left;">刻度</th></tr><tr ng-if="key===\'COLDWATERMETER\'" ng-repeat="item in list"><td ng-bind="item.title"></td><td class="bootstrap-switch-square"><input type="checkbox" flat-switch="" data-on-color="primary" data-on-text="开" data-on-value="EMC_ON" data-off-text="关" data-off-value="EMC_OFF" data-command="{{(item.command|filter:\'EMC_SWITCH\').join()}}" data-sensorid="{{item.id}}" ng-checked="item.status.switch===\'EMC_ON\'"></td><td style="text-align:left;"><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'01\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td></tr><tr ng-if="key===\'HOTWATERMETER\'"><th style="width:25%;">传感器</th><th style="width:100px;">开关</th><th style="text-align:left;">刻度</th></tr><tr ng-if="key===\'HOTWATERMETER\'" ng-repeat="item in list"><td ng-bind="item.title"></td><td class="bootstrap-switch-square"><input type="checkbox" flat-switch="" data-on-color="primary" data-on-text="开" data-on-value="EMC_ON" data-off-text="关" data-off-value="EMC_OFF" data-command="{{(item.command|filter:\'EMC_SWITCH\').join()}}" data-sensorid="{{item.id}}" ng-checked="item.status.switch===\'EMC_ON\'"></td><td style="text-align:left;"><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'03\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td></tr><tr ng-if="key===\'ELECTRICITYMETER\'"><th style="width:25%;">传感器</th><th style="width:100px;">开关</th><th style="text-align:left;">功率</th></tr><tr ng-if="key===\'ELECTRICITYMETER\'" ng-repeat="item in list"><td ng-bind="item.title"></td><td class="bootstrap-switch-square"><input type="checkbox" flat-switch="" data-on-color="primary" data-on-text="开" data-on-value="EMC_ON" data-off-text="关" data-off-value="EMC_OFF" data-command="{{(item.command|filter:\'EMC_SWITCH\').join()}}" data-sensorid="{{item.id}}" ng-checked="item.status.switch===\'EMC_ON\'"></td><td style="text-align:left;"><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'11\'].lasttotal"></span> <span class="form-control-feedback">KWh</span></div></td></tr><tr ng-if="key===\'TEMPRATURECONTROL\'"><th style="width:15%;">温控器名</th><th style="width:100px;">开关</th><th>设置温度</th><th style="width:87px;">当前温度</th><th>能量值(度)</th><th style="min-width:130px;">风速</th><th style="min-width:270px;">模式</th></tr><tr ng-if="key===\'TEMPRATURECONTROL\'" ng-repeat="item in list"><td ng-bind="item.title"></td><td class="bootstrap-switch-square"><input type="checkbox" flat-switch="" data-on-color="primary" data-on-text="开" data-on-value="EMC_ON" data-off-text="关" data-off-value="EMC_OFF" data-command="{{(item.command|filter:\'EMC_SWITCH\').join()}}" data-sensorid="{{item.id}}" ng-checked="item.status.switch===\'EMC_ON\'"></td><td><div flat-slider="" data-max="15" data-command="{{(item.command|filter:\'EMC_TEMPRATURE\').join()}}" data-sensorid="{{item.id}}" data-value="{{item.channels[\'37\'].lasttotal}}"></div></td><td><div class="form-group form-group-sm has-feedback focus"><span class="form-control text-right" ng-bind="item.channels[\'40\'].lasttotal"></span> <span class="form-control-feedback"><i class="em em-degree"></i></span></div></td><td><div class="input-group input-group-sm focus"><span class="input-group-addon"><i class="em em-charging"></i></span> <span class="form-control" ng-bind="item.channels[\'33\'].lasttotal"></span></div></td><td><div flat-speed="" data-command="{{(item.command|filter:\'EMC_WINDSPEED\').join()}}" data-sensorid="{{item.id}}" data-status="{{item.status.mode}}"></div></td><td><div class="btn-group" flat-mode="" data-command="{{(item.command|filter:\'EMC_MODE\').join()}}" data-sensorid="{{item.id}}" data-status="{{item.status.mode}}"></div></td></tr></table></div></div>'),EMAPP.register.directive("flatSlider",["$api","$timeout",function(e,t){return{restrict:"A",scope:{},template:function(){return['<div class="ui-slider"></div>','<div class="text-left" style="min-width:200px;line-height:24px;">','<span class="text-muted">范围：16 ~ 30<i class="em em-degree"></i></span>&nbsp;&nbsp;','<span class="text-info">当前：{{value+15}}<i class="em em-degree"></i></span>',"</div>"].join("")},link:function(i,n,c,a){c.command&&i.$watch(c.command,function(){var a=null,r=angular.extend({min:1,max:10,value:5,orientation:"horizontal",range:"min",slide:function(n,r){i.value!==r.value&&(a&&t.cancel(a),a=t(function(){e.control.send({id:c.sensorid,command:c.command,param:{value:r.value+15}})},500),t(function(){i.value=r.value}))}},n.data());r.value>r.max&&(r.value=Math.ceil(r.value%r.max)),i.value=r.value,n.children(".ui-slider").slider(r)})}}}]),EMAPP.register.directive("flatMode",["$api",function(e){return{restrict:"A",scope:{},template:function(){return['<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===1}" ng-click="mode(1)"><i class="em em-snow"></i>制冷</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===2}" ng-click="mode(2)"><i class="em em-sun"></i>制热</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===3}" ng-click="mode(3)"><i class="em em-clear-wet"></i>除湿</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===4}" ng-click="mode(4)"><i class="em em-ventilation"></i>通风</a>'].join("")},link:function(t,i,n,c){n.command&&t.$watch(n.command,function(){t.current={EMC_COOLING:1,EMC_HEATING:2,EMC_DEHUMIDIFYING:3,EMC_VERTILATING:4}[n.status]||0,t.mode=function(i){t.current=i,e.control.send({id:n.sensorid,command:n.command,param:{mode:{1:"EMC_COOLING",2:"EMC_HEATING",3:"EMC_DEHUMIDIFYING",4:"EMC_VERTILATING"}[i]}})}})}}}]),EMAPP.register.directive("flatSpeed",["$api",function(e){return{restrict:"A",scope:{},template:function(){return['<i class="em em-speed-three" ng-class="{active:current===3}" ng-click="speed(3)"></i>','<i class="em em-speed-four" ng-class="{active:current===4}" ng-click="speed(4)"></i>','<i class="em em-speed-five" ng-class="{active:current===5}" ng-click="speed(5)"></i>'].join("")},link:function(t,i,n,c){n.command&&t.$watch(n.command,function(){t.current=0,t.speed=function(i){t.current=i,e.control.send({id:n.sensorid,command:n.command,param:{mode:{3:"EMC_LOW",4:"EMC_MEDIUM",5:"EMC_HIGH"}[i]}})}})}}}]),EMAPP.register.directive("flatSwitch",["$api","$timeout",function(e,t){return{restrict:"A",link:function(i,n,c,a){c.ngChecked?(n.bootstrapSwitch("disabled",!0),i.$watch(c.ngChecked,function(i){t(function(){c.command&&n.bootstrapSwitch("disabled",!1).bootstrapSwitch("state",i).on("switchChange.bootstrapSwitch",function(i,n){t(function(){e.control.send({id:c.sensorid,command:c.command,param:{mode:n?c.onValue:c.offValue}})})})})})):n.bootstrapSwitch()}}}]),EMAPP.register.controller("project.control",["$api","$timeout",function(e,t){var i=this,n=function(){$(".slimScrollDiv,div[slimscroll]").height($(window).height()-$("div[slimscroll]").offset().top-15)};return $(window).resize(n),n(),e.device.type({project:EMAPP.Project.current._id},function(e){i.deviceType=e.result,(i.deviceType.select=function(e){i.deviceType.selected=e,i.monitorData=[],$("div[slimscroll]").slimScroll&&$("div[slimscroll]").slimScroll({scrollBy:0,scrollTo:0}),$("div.slimScrollBar").css({top:0}),i.list()})(i.deviceType[0])}),i.list=function(c){i.monitorData.loading=!0,e.business.monitor(angular.extend({devicetype:i.deviceType.selected.id,project:EMAPP.Project.current._id,ext:{enableMask:1},groupby:"SENSOR",pageindex:1,pagesize:1e4},angular.isObject(c)?c:angular.isNumber(c)?{pageindex:c}:{}),function(e){e=e.result[EMAPP.Project.current._id]||{},angular.forEach(e.detail,function(e){e.devicetype&&(this[e.devicetype]=this[e.devicetype]||[],this[e.devicetype].push(e))},i.monitorData={}),t(n)})},i}]);