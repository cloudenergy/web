EMAPP.templateCache.put("dist/html/login.html?rev=fda26d3a5b",'<div class="login-container"><form class="login-form text-center" ng-submit="self.login()" novalidate autocomplete="off"><h4>古鸽云能源用户平台</h4><div class="form-group has-feedback"><input type="text" class="form-control login-field" ng-model="self.user" maxlength="50" placeholder="用户名"> <i class="form-control-feedback em em-card"></i></div><div class="form-group has-feedback"><input type="password" class="form-control login-field" ng-model="self.passwd" maxlength="18" placeholder="密码"> <i class="form-control-feedback em em-key"></i></div><div class="form-group"><button type="submit" class="btn btn-primary btn-block">登录 <i class="em em-login"></i></button></div></form></div>'),EMAPP.register.controller("EMAPP.login",["$state","$stateParams","$api","$cookies","md5","SweetAlert",function(t,e,o,n,a,r){var s=this,i=e.action||"logout",u=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,l=function(e){!function(t,e){t&&angular.forEach(EMAPP.ErrorCode,function(o,n){parseInt(t)===parseInt(n)&&(e=o)}),e&&r.error.apply(r,angular.isArray(e)?e:[e])}(e.code||e.err,e.message),EMAPP.User=e&&e.result||EMAPP.User||{},angular.forEach(["token","user"],function(t){EMAPP.User[t]&&n.put(t,EMAPP.User[t]||!1,{path:"/",domain:u,expires:new Date((new Date).setMonth((new Date).getMonth()+1))})}),EMAPP.User.token?t.go("dashboard"):t.go("auth",{action:"login"})};return s.login=function(){var t=this&&this.user,e=this&&this.passwd,n=[];!t&&n.push("帐号"),!e&&n.push("密码"),n=n.join("与"),n&&r.warning("请输入您的"+n),!n&&o.auth.login({user:t,passwd:a.createHash(e).toUpperCase()},l,function(t){l(t.data)})},s.logout=function(){o.auth.logout({redirect:"/"},function(){EMAPP.User={},angular.forEach(["token","user"],function(t){n.remove(t,{path:"/"}),n.remove(t,{path:"/",domain:u}),n.remove(t,{path:"/",domain:".www"+u})}),t.go("auth",{action:"login"})})},"logout"===i&&s.logout(),this}]);