window.EMAPP=angular.module("EMAPP",["ngCookies","ngResource","ngSanitize","ui.router"]);
EMAPP.api={auth:["auth",,{login:{},logout:{}}],project:["project",,{info:{}}],business:["business",,{calendar:{cache:!0,timeout:3e4},dailycost:{timeout:3e4},monthlykgce:{timeout:3e4},energyconstitute:{timeout:3e4},dailysensordetail:{timeout:3e4},energyeffectiverate:{timeout:3e4},projectdetail:{timeout:3e4},monitor:{},channeldetail:{},buildingstatistic:{},energyincomerate:{},energytimeline:{},socitystatistic:{},socitydetail:{},socitytimeline:{},settlereport:{},monthlyreport:{},dailyreport:{},recentchargelog:{},departments:{},departmentusage:{}}],energy:["energy",,{info:{cache:!0}}],control:["control",,{send:{}}],device:["device",,{type:{cache:!0}}],message:["message",,{arreargereminder:{}}]};
EMAPP.config(["$animateProvider","$controllerProvider","$compileProvider","$filterProvider","$injector","$provide","$httpProvider","$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,r,n,o,a,i,s,c,u){EMAPP.register={controller:t.register,directive:r.directive,filter:n.register,provider:a.provider,constant:a.constant,value:a.value,factory:a.factory,service:a.service},s.html5Mode(!0),i.interceptors.push(["$q","$location","SweetAlert","viewMask",function(e,t,r,n){var o=function(o){return n.close(),o.data&&(90000005===o.data.code?t.url("/dashboard/auth/logout").replace():o.data.message&&r[200===o.status?"success":"error"](o.data.message)),200===o.status?o:e.reject(o)};return{request:function(e){return n.open(),e.url&&/\/api\//i.test(e.url)&&e.method&&(delete(e.data||e.params||{})._api_action,e.url=decodeURIComponent(e.url)),e},requestError:function(t){return e.reject(t)},response:o,responseError:o}}]),a.service("lazyLoad",["$q","$timeout","viewMask",function(e,t,r){this.cache={},this.css=function(n){var o,a,i=this.cache,s=e.defer(),c=[],u=navigator.userAgent;return"boolean"==typeof arguments[1]?(o=arguments[2],a=arguments[1]):(o=arguments[1],a=arguments[2]),angular.forEach(n instanceof Array?n:[n],function(r,n,o){n=i[r]||e.defer(),c.push(n.promise),i[r]||(o=document.createElement("link"),o.rel="stylesheet",a?i[r]=n:o.className="lazyLoad-stylesheet",/(?:Android);?[\s\/]+([\d.]+)?/i.test(u)||/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/i.test(u)?!function s(e,r){if(/webkit/i.test(u))o.sheet&&(r=!0);else if(o.sheet)try{o.sheet.cssRules&&(r=!0)}catch(a){("SecurityError"===a.name||1e3===a.code)&&(r=!0)}r||e>=200?n.resolve():t(function(){s(e+1)},10)}(0):o[document.addEventListener?"onload":"onreadystatechange"]=function(e,t){(t||!o.readyState||/loaded|complete/.test(o.readyState))&&n.resolve()},o.onerror=function(){n.reject(r)},o.setAttribute("charset","utf-8"),o.href=r,(document.head||document.getElementsByTagName("head")[0]).appendChild(o))}),r.open(),e.all(c).then(function(){(o||angular.noop)(),t(s.resolve),r.close()},function(){t(s.reject),r.close(),console.error("lazyLoad-css-error:",arguments[0])}),s.promise},this.js=function(n){var o=this.cache,a=e.defer(),i=[],s=[],c=arguments[1];return angular.forEach(n instanceof Array?n:[n],function(t,r){r=o[t]||e.defer(),i.push(r.promise),o[t]||(o[t]=r,s.push(t))}),function u(e,t,r){(r=s[e])&&(t=document.createElement("script"),t[document.addEventListener?"onload":"onreadystatechange"]=function(n,a){(a||!t.readyState||/loaded|complete/.test(t.readyState))&&(document.body.removeChild(t),o[r].resolve(),u(e+1))},t.onerror=function(){o[r].reject(r),u(e+1)},t.setAttribute("charset","utf-8"),t.src=r,document.body.appendChild(t))}(0),r.open(),e.all(i).then(function(){(c||angular.noop)(),t(a.resolve),r.close()},function(){t(a.reject),r.close(),console.error("lazyLoad-js-error:",arguments[0])}),a.promise}}]),a.provider("loadModules",function(){var i={},s=[],c={$animateProvider:e,$controllerProvider:t,$compileProvider:r,$filterProvider:n,$injector:o,$provide:a};this.$get=["$injector","$log",function(e,t){function r(e,t){angular.forEach(t,function(t,r){if(r=c[t[0]])if("invoke"!==t[1])r[t[1]].apply(r,t[2]);else{var n=function(n){-1===s.indexOf(e+"-"+n)&&(s.push(e+"-"+n),r[t[1]].apply(r,t[2]))};angular.isFunction(t[2][0])?n(t[2][0]):angular.isArray(t[2][0])&&angular.forEach(t[2][0],function(e){angular.isFunction(e)&&n(e)})}})}function n(e){var o,a=[];return angular.forEach(angular.isArray(e)?e:[e],function(e){if(e&&!i[e]){i[e]=!0;try{angular.isString(e)?(o=angular.module(e))&&(a=a.concat(n(o.requires)).concat(o._runBlocks),r(e,o._invokeQueue),r(e,o._configBlocks)):(angular.isFunction(e)||angular.isArray(e))&&a.push(e)}catch(s){throw angular.isArray(e)&&(e=e[e.length-1]),s.message&&s.stack&&-1==s.stack.indexOf(s.message)&&(s=s.message+"\n"+s.stack),t.error("Failed to instantiate module "+e+" due to:\n"+(s.stack||s.message||s))}}}),a}return function(t){angular.forEach(n(t),function(t){e.invoke(t)})}}]}),a.factory("routerSetup",function(){return function(){angular.forEach(EMAPP.States,function(e,t){c.state(t,e)}),u.otherwise(function(e,t){t.url(EMAPP.User.token?"/dashboard":"/dashboard/auth/login").replace()})}}),a.service("$api",["$resource",function(e){var t=function(e,t){return(/(^http:\/\/)|(^https:\/\/)|(^\/)/.test(e)?e:location.protocol+"//"+location.host+"/api/"+e)+(t?"/:_api_action":"")};angular.forEach(EMAPP.api,function(r,n){if(r instanceof Array){var o=r[0],a=r[1],i=r[2],s=r[3];o&&(this[n]=e(t(o,!0),a,angular.forEach(angular.extend({get:{method:"GET"},list:{method:"GET"},search:{method:"GET"},set:{},create:{},update:{},remove:{},"delete":{}},i),function(e,r){e=e||{},e.url&&(e.url=t(e.url)),e.method=e.method||"POST",e.params=angular.extend(e.url?{}:{_api_action:r},e.params),e.timeout=1e4}),s))}},this)}]),a.factory("SweetAlert",function(){return{swal:window.swal,success:function(e,t){this.swal(e,t,"success")},error:function(e,t){this.swal(e,t,"error")},warning:function(e,t){this.swal(e,t,"warning")},info:function(e,t){this.swal(e,t,"info")}}}),a.service("viewMask",["$timeout",function(e){var t=0,r=$('<div class="view-mask"><div class="progress"><div class="progress-bar progress-bar-striped active" style="width: 100%"></div></div></div>').appendTo(document.body),n=function(n,o,a){o?(t++,r.show()):(a?t=0:t--,0>=t&&r.hide()),e(n||angular.noop)};r.hide(),this.open=function(){n(arguments[0],!0)},this.close=function(){var t,r;arguments[0]instanceof Function?(t=arguments[0],r=arguments[1]):(t=null,r=arguments[0]),e(function(){n(t,!1,r)},200)}}]),a.factory("uuid",function(){return function e(t,r){var n,o,e=[],a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");if(r=r||a.length,t)for(n=0;t>n;n++)e[n]=a[0|Math.random()*r];else for(e[8]=e[13]=e[18]=e[23]="-",e[14]="4",n=0;36>n;n++)e[n]||(o=0|16*Math.random(),e[n]=a[19==n?3&o|8:o]);return e.join("")}})}]);
EMAPP.factory("ErrorCode",["SweetAlert",function(e){return function(r,a){switch(r){case 20000001:a="用户不存在";break;case 90000001:a="服务器错误";break;case 90000002:a="拒绝访问";break;case 90000003:a="登录失败";break;case 90000004:a="权限不足";break;case 90000005:a="未登录";break;case 90000006:a=["验证失败","账号或密码有误"];break;case 90000007:a="签名校验失败"}return a&&e.error.apply(e,angular.isArray(a)?a:[a]),r}}]);
EMAPP.States={auth:{url:"/dashboard/auth/:action",templateUrl:"dist/html/login.min.html?rev=1d0ac12c43",controller:"EMAPP.login",controllerAs:"self",data:{title:"用户登录"},resolve:{scripts:["lazyLoad","loadModules",function(s,i){return s.js(["/dist/js/controllers/login.min.js?rev=608d736176","/vendor/angular-md5/angular-md5.min.js?rev=cf3572fb49"],function(){i("ngMd5")})}]}},dashboard:{url:"/dashboard",templateUrl:"dist/html/dashboard.min.html?rev=a4db072ff5",controller:"EMAPP.dashboard",controllerAs:"self",resolve:{scripts:["lazyLoad",function(s){return s.js("/dist/js/controllers/dashboard.min.js?rev=5e31dfcaed")}]}},"dashboard.main":{url:"/main",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/main.min.html?rev=48fdcc9318",controller:"project.main",controllerAs:"self"}},data:{title:"首页"},resolve:{styles:["lazyLoad",function(s){return s.css("/dist/css/project/main.min.css?rev=c3920ed852",!0)}],scripts:["lazyLoad",function(s){return s.js(["/dist/js/controllers/project/main.min.js?rev=bae2b3bb9c","/dist/js/directives/datetimepicker.min.js?rev=69b05dc82e","/dist/js/directives/highcharts.min.js?rev=d140bc386b","/dist/js/services/pies.min.js?rev=9e992384fa","/dist/js/services/lines.min.js?rev=084292a01c","/vendor/highcharts/highcharts.min.js?rev=6d957b772b"])}]}},"dashboard.monitor":{url:"/monitor",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/monitor.min.html?rev=3ab24d9c8d",controller:"project.monitor",controllerAs:"self"}},data:{title:"设备监控"},resolve:{styles:["lazyLoad",function(s){return s.css("/dist/css/project/monitor.min.css?rev=ef319091d6",!0)}],scripts:["lazyLoad",function(s){return s.js(["/dist/js/controllers/project/monitor.min.js?rev=4198bde733","/dist/js/directives/datetimepicker.min.js?rev=69b05dc82e","/dist/js/directives/highcharts.min.js?rev=d140bc386b","/dist/js/directives/slimscroll.min.js?rev=5de214d4bb","/dist/js/services/lines.min.js?rev=084292a01c","/vendor/highcharts/highcharts.min.js?rev=6d957b772b"])}]}},"dashboard.control":{url:"/control",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/control.min.html?rev=7ad46c7abe",controller:"project.control",controllerAs:"self"}},data:{title:"设备控制"},resolve:{styles:["lazyLoad",function(s){return s.css("/dist/css/project/control.min.css?rev=45fd79b319",!0)}],scripts:["lazyLoad",function(s){return s.js(["/dist/js/controllers/project/control.min.js?rev=f6f10372ee","/dist/js/directives/slimscroll.min.js?rev=5de214d4bb","/vendor/jshashes/hashes.min.js?rev=26d6efaea1"])}]}},"dashboard.analyze":{url:"/analyze",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/analyze.min.html?rev=dc14096329"}},data:{title:"能耗分析"},resolve:{styles:["lazyLoad",function(s){return s.css("/dist/css/project/analyze.min.css?rev=2005e8bea1",!0)}],scripts:["lazyLoad",function(s){return s.js(["/dist/js/controllers/project/analyze.min.js?rev=1afbe540c2","/dist/js/directives/slimscroll.min.js?rev=5de214d4bb","/dist/js/directives/highcharts.min.js?rev=d140bc386b","/dist/js/services/pies.min.js?rev=9e992384fa","/dist/js/services/lines.min.js?rev=084292a01c","/vendor/highcharts/highcharts.min.js?rev=6d957b772b"])}]}},"dashboard.statistic":{url:"/statistic/:tab",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/statistic.min.html?rev=bd4bbaabd8",controller:"project.statistic",controllerAs:"self"}},data:{title:"能耗统计"},resolve:{styles:["lazyLoad",function(s){return s.css(["/dist/css/project/statistic.min.css?rev=f2ba8c648f","/vendor/angular-ui-grid/ui-grid.min.css?rev=00a71d1d80"],!0)}],scripts:["lazyLoad","loadModules",function(s,i){return s.js(["/vendor/angular-ui-grid/ui-grid.min.js?rev=8f81f54e70","/dist/js/directives/datetimepicker.min.js?rev=69b05dc82e","/dist/js/controllers/project/statistic.min.js?rev=7e0881f859"],function(){i(["ui.grid","ui.grid.autoResize","ui.grid.exporter","ui.grid.moveColumns","ui.grid.resizeColumns"])})}]}},"dashboard.financial":{url:"/financial/:tab",views:{"dashboard@dashboard":{templateUrl:"dist/html/project/financial/view.min.html?rev=951b2af9cd"}},data:{title:"财务"},resolve:{styles:["lazyLoad",function(s){return s.css(["/dist/css/project/statistic.min.css?rev=f2ba8c648f","/vendor/angular-ui-grid/ui-grid.min.css?rev=00a71d1d80"],!0)}],scripts:["lazyLoad","loadModules",function(s,i){return s.js(["/vendor/angular-ui-grid/ui-grid.min.js?rev=8f81f54e70","/dist/js/directives/datetimepicker.min.js?rev=69b05dc82e","/dist/js/controllers/project/financial.min.js?rev=1b9f406fac"],function(){i(["ui.grid","ui.grid.autoResize","ui.grid.exporter","ui.grid.moveColumns","ui.grid.resizeColumns","ui.grid.infiniteScroll"])})}]}}};
EMAPP.run(["$rootScope","$cookies","$templateCache","$state","routerSetup",function(e,t,a,o,n){o.prev={},e.$on("$stateChangeStart",function(e,t,a,n,r){EMAPP.lazyLoadStylesheet=$("link[class=lazyLoad-stylesheet]"),EMAPP.User.token?("dashboard"!==t.name&&"auth"!==t.name&&(o.prev.state=t.name,o.prev.params=a,EMAPP.Project||(e.preventDefault(),o.go("dashboard"))),EMAPP.Project&&"dashboard"===t.name&&(e.preventDefault(),o.go(o.prev.state||"dashboard.main",o.prev.params))):"auth"!==t.name&&(e.preventDefault(),o.go("auth",{action:"login"}))}),e.$on("$stateChangeSuccess",function(e,t,a,o,n){EMAPP.lazyLoadStylesheet&&EMAPP.lazyLoadStylesheet.remove(),function(e){t.data&&t.data.title&&e.push(t.data.title),EMAPP.Project&&EMAPP.Project.name&&e.push(EMAPP.Project.name),document.title=e.join(" - ")}([])}),EMAPP.templateCache=a,n(),angular.forEach(t.getAll(),function(e,t){this[t]=e},EMAPP.User={})}]);
$(function(){$(document.body).html("<section ui-view></section>"),angular.bootstrap(document,["EMAPP"])});