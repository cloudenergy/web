window.EMAPP=angular.module("EMAPP",["ngCookies","ngResource","ui.router","oc.lazyLoad"]).config(["$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,r,a,o,n,i,s){EMAPP.register={controller:e.register,directive:t.directive,filter:r.register,provider:a.provider,constant:a.constant,value:a.value,factory:a.factory,service:a.service},angular.forEach(EMAPP.States,function(e,t){i.state(t,e)}),s.otherwise(function(e,t){t.url(EMAPP.User.token?"/dashboard":"/dashboard/auth/login").replace()}),n.html5Mode(!0),o.interceptors.push(["$q","$location","SweetAlert","viewMask",function(e,t,r,a){var o=function(o){return a.close(),o.data&&(90000005===o.data.code?t.url("/dashboard/auth/logout").replace():o.data.message&&r[200===o.status?"success":"error"](o.data.message)),200===o.status?o:e.reject(o)};return{request:function(e){return a.open(),e.url&&/\/api\//i.test(e.url)&&e.method&&(delete(e.data||e.params||{})._api_action,e.url=decodeURIComponent(e.url)),e},requestError:function(t){return e.reject(t)},response:o,responseError:o}}])}]).run(["$rootScope","$cookies","$templateCache","$state",function(e,t,r,a){EMAPP.templateCache=r,a.prev={},e.$on("$stateChangeStart",function(e,t,r,o,n){EMAPP.User.token?("dashboard"!==t.name&&"auth"!==t.name&&(a.prev.state=t.name,a.prev.params=r,EMAPP.Project||(e.preventDefault(),a.go("dashboard",r))),EMAPP.Project&&"dashboard"===t.name&&(e.preventDefault(),a.go(a.prev.state||"dashboard.main",a.prev.params))):"auth"!==t.name&&(e.preventDefault(),a.go("auth",angular.extend(r,{action:"login"})))}),e.$on("$stateChangeSuccess",function(e,t,r,a,o){!function(e){t.data&&t.data.title&&e.push(t.data.title),EMAPP.title&&e.push(EMAPP.title),document.title=e.join(" - ")}([])}),angular.forEach(t.getAll(),function(e,t){this[t]=e},EMAPP.User={})}]),angular.element(document).ready(function(){angular.element(document.body).html("<section ui-view></section>"),angular.bootstrap(document,["EMAPP"])});
EMAPP.api={auth:["auth",,{login:{},logout:{}}],project:["project",,{info:{}}],business:["business",,{calendar:{cache:!0},dailycost:{},monthlykgce:{},energyconstitute:{},dailysensordetail:{},energyeffectiverate:{},projectdetail:{},monitor:{},channeldetail:{},buildingstatistic:{},energyincomerate:{},energytimeline:{},socitystatistic:{},socitydetail:{},socitytimeline:{},groupanalysis:{},settlereport:{},monthlyreport:{},dailyreport:{},projectreport:{},recentchargelog:{},departments:{},departmentusage:{}}],energy:["energy",,{info:{cache:!0}}],control:["control",,{send:{}}],device:["device",,{type:{cache:!0}}],message:["message",,{arreargereminder:{}}]};
EMAPP.factory("$api",["$resource",function(a){return function(t){return angular.forEach(EMAPP.api,function(r,n){if(r instanceof Array){var o=r[0],i=r[1],u=r[2],c=r[3];o&&(this[n]=a(t(o,!0),i,angular.forEach(u,function(a,r){a=a||{},a.url&&(a.url=t(a.url)),a.method=a.method||"POST",a.params=angular.extend(a.url?{}:{_api_action:r},a.params)}),c))}},EMAPP.api={}),EMAPP.api}(function(a,t){return(/(^http:\/\/)|(^https:\/\/)|(^\/)/.test(a)?a:location.protocol+"//"+location.host+"/api/"+a)+(t?"/:_api_action":"")})}]);
EMAPP.factory("SweetAlert",function(){return{swal:function(){return(window.swal||angular.noop).apply(window.swal||angular.noop,arguments)},success:function(n,s){this.swal(n,s,"success")},error:function(n,s){this.swal(n,s,"error")},warning:function(n,s){this.swal(n,s,"warning")},info:function(n,s){this.swal(n,s,"info")}}});
EMAPP.factory("viewMask",["$timeout",function(n){var s=0,e=angular.element(document.body).append('<div class="view-mask"><div class="progress"><div class="progress-bar progress-bar-striped active" style="width:100%"></div></div></div>').children(".view-mask"),a=function(a,i,r){i?(s++,e.css({display:"block"})):(r?s=0:s--,0>=s&&e.css({display:"none"})),n(a||angular.noop)};return{open:function(){a(arguments[0],!0)},close:function(){var s,e;arguments[0]instanceof Function?(s=arguments[0],e=arguments[1]):(s=null,e=arguments[0]),n(function(){a(s,!1,e)},200)}}}]);