window.EMAPP=angular.module("EMAPP",["ngCookies","ngResource","ui.router","oc.lazyLoad"]).config(["$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,r,a,o,n,i,s){EMAPP.register={controller:e.register,directive:t.directive,filter:r.register,provider:a.provider,constant:a.constant,value:a.value,factory:a.factory,service:a.service},angular.forEach(EMAPP.States,function(e,t){i.state(t,e)}),s.otherwise(function(e,t){t.url(EMAPP.User.token?"/dashboard":"/dashboard/auth/login").replace()}),n.html5Mode(!0),o.interceptors.push(["$q","$location","SweetAlert",function(e,t,r){var a=function(a){return a.data&&(90000005===a.data.code?t.url("/dashboard/auth/logout").replace():a.data.message&&r[200===a.status?"success":"error"](a.data.message)),200===a.status?a:e.reject(a)};return{request:function(e){return e.url&&/\/api\//i.test(e.url)&&e.method&&(delete(e.data||e.params||{})._api_action,e.url=decodeURIComponent(e.url)),e},requestError:function(t){return e.reject(t)},response:a,responseError:a}}])}]).run(["$rootScope","$cookies","$templateCache","$state",function(e,t,r,a){EMAPP.templateCache=r,a.prev={},e.$on("$stateChangeStart",function(e,t,r,o,n){EMAPP.User.token?("dashboard"!==t.name&&"auth"!==t.name&&(a.prev.state=t.name,a.prev.params=r,EMAPP.Project||(e.preventDefault(),a.go("dashboard",r))),EMAPP.Project&&"dashboard"===t.name&&(e.preventDefault(),a.go(a.prev.state||"dashboard.main",a.prev.params))):"auth"!==t.name&&(e.preventDefault(),a.go("auth",angular.extend(r,{action:"login"})))}),e.$on("$stateChangeSuccess",function(e,t,r,a,o){!function(e){t.data&&t.data.title&&e.push(t.data.title),EMAPP.title&&e.push(EMAPP.title),document.title=e.join(" - ")}([])}),angular.forEach(t.getAll(),function(e,t){this[t]=e},EMAPP.User={})}]),angular.element(document).ready(function(){angular.element(document.body).html('<div preloader class="preloader" ng-show="preloader"></div><section ui-view></section>'),angular.bootstrap(document,["EMAPP"])});
EMAPP.api={auth:["auth",,{login:{},logout:{}}],project:["project",,{info:{}}],business:["business",,{calendar:{cache:!0},dailycost:{},monthlykgce:{},energyconstitute:{},dailysensordetail:{},energyeffectiverate:{},projectdetail:{},monitor:{},channeldetail:{},buildingstatistic:{},energyincomerate:{},energytimeline:{},socitystatistic:{},socitydetail:{},socitytimeline:{},groupanalysis:{},settlereport:{},monthlyreport:{},dailyreport:{},projectreport:{},recentchargelog:{},departments:{},departmentusage:{}}],energy:["energy",,{info:{cache:!0}}],control:["control",,{send:{}}],device:["device",,{type:{cache:!0}}],message:["message",,{arreargereminder:{}}],customer:["customer",,{info:{}}]};
EMAPP.factory("$api",["$resource",function(a){return function(t){return angular.forEach(EMAPP.api,function(r,o){if(r instanceof Array){var n=r[0],i=r[1],c=r[2],u=r[3];n&&(this[o]=a(t(n,!0),i,angular.forEach(c,function(a,r){a=a||{},a.url&&(a.url=t(a.url)),a.method=a.method||"POST",a.params=angular.extend(a.url?{}:{_api_action:r},a.params)}),u))}},EMAPP.api={}),EMAPP.api}(function(a,t){return(/(^http:\/\/)|(^https:\/\/)|(^\/)/.test(a)?a:location.protocol+"//"+location.host+(localStorage.testapi?"/testapi/":"/api/")+a)+(t?"/:_api_action":"")})}]);
EMAPP.factory("SweetAlert",function(){return{swal:function(){return(window.swal||angular.noop).apply(window.swal||this,arguments)},success:function(n,r){return this.swal(n,r,"success")},error:function(n,r){return this.swal(n,r,"error")},warning:function(n,r){return this.swal(n,r,"warning")},info:function(n,r){return this.swal(n,r,"info")}}});
"use strict";!function(r,t){EMAPP.config(["$httpProvider",function(t){t.interceptors.push(["$q",function(t){var e=function(e){return r--,200===e.status?e:t.reject(e)};return{request:function(t){return r++,t},requestError:function(r){return t.reject(r)},response:e,responseError:e}}])}]).directive("preloader",["$timeout",function(e){return{restrict:"A",scope:!0,link:function(n){n.$watch(function(){return r},function(r){t&&e.cancel(t),0===r?t=e(function(){n.preloader=r},500):n.preloader=r})}}}])}(0);