EMAPP.register.directive("pagination",["$timeout",function(e){"use strict";return{restrict:"E",replace:!0,scope:{config:"=",click:"="},template:'<div><ul><li ng-repeat="item in paging" ng-class="{active:active===item.val}"><a ng-href="{{item.href}}" ng-click="click(item.page)" ng-bind-html="item.val"></a></li></ul><div>',link:function(i,a){i.$watch(function(){return i.config},function(n){if(n){n=angular.extend({pageindex:1,pagesize:15,count:0,split:5,prevName:'<i class="glyphicon glyphicon-chevron-left"></i>',nextName:'<i class="glyphicon glyphicon-chevron-right"></i>'},n),n.pagecount=Math.ceil(n.count/n.pagesize),n.pagegroup=Math.ceil(n.pagecount/n.split),n.groupindex=Math.ceil(n.pageindex/n.split);var p,t,g=[],c=n.split;for(n.prevName&&n.pageindex>1&&g.push({prev:!0,page:n.pageindex-1,val:n.prevName,href:"javascript:void(0)"}),n.pagegroup>1&&n.groupindex>1&&g.push({first:!0,page:1,val:"1...",href:"javascript:void(0)"}),p=0;c>p;p++)t=parseInt((n.groupindex-1)*c+p+1),t<=n.pagecount&&g.push({page:t,val:t,href:"#"+t});n.pagegroup>1&&n.groupindex<n.pagegroup&&g.push({last:!0,page:n.pagecount,val:"..."+n.pagecount,href:"javascript:void(0)"}),n.nextName&&n.pageindex<n.pagecount&&g.push({next:!0,page:n.pageindex+1,val:n.nextName,href:"javascript:void(0)"}),i.active=n.pageindex,i.paging=n.pagecount>1?g:[],e(function(){a.find("a").click(function(){return!1})})}})}}}]);