angular.module("EMAPP").directive("datetimepicker",["$q","$ocLazyLoad",function($q,$ocLazyLoad){var promiseList=[$ocLazyLoad.load([{serie:!0,files:["/vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css?rev=4fe382c5a6","/vendor/moment/min/moment.min.js?rev=677846fe11","/vendor/moment/locale/zh-cn.js","/vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js?rev=6055168fe2"]}])];return{restrict:"EA",require:"?ngModel",link:function(scope,element,attrs,ctrl){var linkLeft,linkRight,options={locale:"zh-CN",format:"YYYY-MM-DD",maxDate:new Date,widgetPositioning:{horizontal:"right"}},promise=[];angular.forEach(element.data(),function(val,key){/^\$/.test(key)||(/^\{.*\}$/.test(val)||/^\[.*\]$/.test(val)?eval("this[key]="+val):this[key]=val)},options),attrs.datetimepicker&&function(e){e=$q.defer(),scope.$watch(attrs.datetimepicker,function(t){void 0!==t&&(angular.extend(options,t),e.resolve(options))}),promise.push(e.promise)}(),$q.all(promiseList.concat(promise)).then(function(){options.linkLeft&&(linkLeft=$(options.linkLeft),delete options.linkLeft),options.linkRight&&(linkRight=$(options.linkRight),delete options.linkRight),element.datetimepicker(options),!options.inline&&element.bind("dp.change",function(e){linkLeft&&linkLeft.length&&linkLeft.data("DateTimePicker")&&linkLeft.data("DateTimePicker").maxDate(e.date),linkRight&&linkRight.length&&linkRight.data("DateTimePicker")&&linkRight.data("DateTimePicker").minDate(e.date),ctrl&&ctrl.$setViewValue(e.target.value)}).bind("dp.show",function(){(element.is("input")?element.parent():element).addClass("focus"),linkLeft&&linkLeft.length&&linkLeft.data("DateTimePicker")&&(linkLeft.data("DateTimePicker").maxDate(element.data("DateTimePicker").date()),linkLeft.data("DateTimePicker").date()&&element.data("DateTimePicker").minDate(linkLeft.data("DateTimePicker").date())),linkRight&&linkRight.length&&linkRight.data("DateTimePicker")&&(linkRight.data("DateTimePicker").minDate(element.data("DateTimePicker").date()),linkRight.data("DateTimePicker").date()&&element.data("DateTimePicker").maxDate(linkRight.data("DateTimePicker").date()))}).bind("dp.hide",function(){(element.is("input")?element.parent():element).removeClass("focus")})})}}}]);