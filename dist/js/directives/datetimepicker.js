angular.module("EMAPP").directive("datetimepicker",["$timeout","$ocLazyLoad",function($timeout,$ocLazyLoad){var pluginLoad=$ocLazyLoad.load([{insertBefore:"#load_styles_before",files:["/vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css?rev=4fe382c5a6"]},{serie:!0,files:["/vendor/moment/min/moment.min.js?rev=677846fe11","/vendor/moment/locale/zh-cn.js","/vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js?rev=6055168fe2"]}]);return{restrict:"EA",require:"?ngModel",link:function(scope,element,attrs,ctrl){pluginLoad.then(function(){var linkLeft,linkRight,options={locale:"zh-CN",format:"YYYY-MM-DD",maxDate:new Date,widgetPositioning:{horizontal:"right"}};angular.forEach(element.data(),function(val,key){/^\$/.test(key)||(/^\{.*\}$/.test(val)||/^\[.*\]$/.test(val)?eval("this[key]="+val):this[key]=val)},options),scope.$watch(attrs.datetimepicker,function(e){attrs.datetimepicker&&!angular.isDefined(e)||(angular.isObject(e)&&angular.extend(options,e),linkLeft=options.linkLeft&&$(options.linkLeft),linkRight=options.linkRight&&$(options.linkRight),delete options.linkLeft,delete options.linkRight,element.datetimepicker(options),!options.inline&&$timeout(function(){var e=linkLeft&&linkLeft.length&&linkLeft.data("DateTimePicker"),t=linkRight&&linkRight.length&&linkRight.data("DateTimePicker"),n=element.data("DateTimePicker"),a=function(a,i){e&&(e.maxDate(a),e.date()&&n.minDate(e.date()),i&&e.date(moment(Math.max(moment(a).subtract(i,"days"),e.date())))),t&&(t.minDate(a),t.date()&&n.maxDate(t.date()),i&&t.date(moment(Math.min(moment(a).add(i,"days"),t.date(),moment()))))};element.off("dp.change").on("dp.change",function(e){ctrl&&ctrl.$setViewValue(e.target.value),a(e.date,attrs.rangeDay&&scope.$eval(attrs.rangeDay))}).off("dp.show").on("dp.show",function(e){(element.is("input")?element.parent():element).addClass("focus"),a(n.date(),attrs.rangeDay&&scope.$eval(attrs.rangeDay))}).off("dp.hide").on("dp.hide",function(){(element.is("input")?element.parent():element).removeClass("focus")})}))})})}}}]);