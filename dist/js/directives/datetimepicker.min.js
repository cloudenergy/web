EMAPP.register.directive("datetimepicker",["$q","lazyLoad",function($q,lazyLoad){var promise=[lazyLoad.css("/vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css?rev=74c5af5cfe",!0),lazyLoad.js(["/vendor/moment/min/moment-with-locales.min.js?rev=8921196249","/vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js?rev=ca3e24059b"])];return{restrict:"EA",require:"?ngModel",link:function(scope,element,attrs,ctrl){var defer,isInput=element.is("input"),options={locale:"zh-CN",format:"YYYY-MM-DD",maxDate:new Date,widgetPositioning:{horizontal:"right"}};angular.forEach(element.data(),function(val,key){/^\$/.test(key)||(/^\{.*\}$/.test(val)||/^\[.*\]$/.test(val)?eval("this[key]="+val):this[key]=val)},options),attrs.datetimepicker&&(defer=$q.defer(),scope.$watch(attrs.datetimepicker,function(e){e&&(angular.extend(options,e),defer.resolve())})),$q.all(defer?promise.concat([defer.promise]):promise).then(function(){element.datetimepicker(options),!options.inline&&element.bind("dp.change",function(e){ctrl&&ctrl.$setViewValue(e.target.value)}).bind("dp.show",function(){isInput?element.parent().addClass("focus"):element.addClass("focus")}).bind("dp.hide",function(){isInput?element.parent().removeClass("focus"):element.removeClass("focus")})})}}}]);