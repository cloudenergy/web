EMAPP.register.directive("controlSlider",["$api","$timeout",function(e,n){return{restrict:"A",scope:{},template:function(){return['<div class="ui-slider"></div>','<div class="text-left" style="min-width:200px;line-height:24px;">','<span class="text-muted">范围：16 ~ 30<i class="emweb web-degree"></i></span>&nbsp;&nbsp;','<span class="text-primary">当前：{{value+15}}<i class="emweb web-degree"></i></span>',"</div>"].join("")},link:function(t,i,a,c){if(!angular.isUndefined(a.command)){var o=t.$watch(a.command,function(){var c=null,o=angular.extend({min:1,max:10,value:5,orientation:"horizontal",range:"min",slide:function(i,o){t.value!==o.value&&(c&&n.cancel(c),c=n(function(){e.control.send({id:a.sensorid,command:a.command,param:{value:o.value+15}})},500),n(function(){t.value=o.value}))}},i.data());o.value>o.max&&(o.value=Math.ceil(o.value%o.max)),t.value=o.value,i.children(".ui-slider").slider(o)});t.$on("$destroy",function(){o()})}}}}]),EMAPP.register.directive("controlMode",["$api",function(e){return{restrict:"A",scope:{},template:function(){return['<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===1}" ng-click="mode(1)"><i class="emweb web-snow"></i>制冷</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===2}" ng-click="mode(2)"><i class="emweb web-sun"></i>制热</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===3}" ng-click="mode(3)"><i class="emweb web-clear-wet"></i>除湿</a>','<a href="javascript:void(0)" class="btn btn-sm btn-primary" ng-class="{active:current===4}" ng-click="mode(4)"><i class="emweb web-ventilation"></i>通风</a>'].join("")},link:function(n,t,i,a){if(!angular.isUndefined(i.command)){var c=n.$watch(i.command,function(){n.current={EMC_COOLING:1,EMC_HEATING:2,EMC_DEHUMIDIFYING:3,EMC_VERTILATING:4}[i.status]||0,n.mode=function(t){n.current=t,e.control.send({id:i.sensorid,command:i.command,param:{mode:{1:"EMC_COOLING",2:"EMC_HEATING",3:"EMC_DEHUMIDIFYING",4:"EMC_VERTILATING"}[t]}})}});n.$on("$destroy",function(){c()})}}}}]),EMAPP.register.directive("controlSpeed",["$api",function(e){return{restrict:"A",scope:{},template:function(){return['<i class="emweb web-speed-three" ng-class="{active:current===3}" ng-click="speed(3)"></i>','<i class="emweb web-speed-four" ng-class="{active:current===4}" ng-click="speed(4)"></i>','<i class="emweb web-speed-five" ng-class="{active:current===5}" ng-click="speed(5)"></i>'].join("")},link:function(n,t,i,a){if(!angular.isUndefined(i.command)){var c=n.$watch(i.command,function(){n.current=0,n.speed=function(t){n.current=t,e.control.send({id:i.sensorid,command:i.command,param:{mode:{3:"EMC_LOW",4:"EMC_MEDIUM",5:"EMC_HIGH"}[t]}})}});n.$on("$destroy",function(){c()})}}}}]),EMAPP.register.directive("controlSwitch",["$api","$timeout","SweetAlert",function(e,n,t){return{restrict:"A",link:function(i,a,c,o){if(angular.isUndefined(c.ngChecked))a.bootstrapSwitch();else{a.bootstrapSwitch("disabled",!0);var r=i.$watch(c.ngChecked,function(i){n(function(o){o=!0,c.command&&a.bootstrapSwitch("disabled",!1).bootstrapSwitch("state",i).on("switchChange.bootstrapSwitch",function(i,r){n(function(){"EMC_SWITCH"===c.command?o&&t.swal({title:"控制校验",text:"",type:"input",inputPlaceholder:"控制密码",animation:"slide-from-top",closeOnConfirm:!1,showCancelButton:!0,showLoaderOnConfirm:!0,cancelButtonText:"取消",confirmButtonText:"确定"},function(i){return i===!1?(o=!1,a.bootstrapSwitch("toggleState"),n(function(){o=!0}),!1):""===i?(t.swal.showInputError("请输入控制密码"),!1):void e.control.send({id:c.sensorid,command:c.command,param:{mode:r?c.onValue:c.offValue},ctrlcode:(new Hashes.SHA1).hex(i).toUpperCase()},function(e){0===e.code?t.success("操作成功！"):t.swal({title:"控制密码校验失败！",text:"",type:"error",confirmButtonText:"关闭"},function(){o=!1,a.bootstrapSwitch("toggleState"),n(function(){o=!0})})})}):e.control.send({id:c.sensorid,command:c.command,param:{mode:r?c.onValue:c.offValue}})})})})});i.$on("$destroy",function(){r()})}}}}]);